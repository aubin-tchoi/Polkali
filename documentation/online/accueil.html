<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Documentation">
    <meta name="author" content="Aubin Tchoï">
    <title>Dashboard KPI · Ponts Études Projets</title>

    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

    <!-- Custom CSS -->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
    <style>
        <?!= include("styles/carousel-css"); ?>
        <?!= include("styles/features-css"); ?>
        <?!= include("styles/sidebars-css"); ?>
        <?!= include("styles/prettify-tomorrow-css"); ?>
        <?!= include("styles/jsdoc-default-css"); ?>
    </style>

    <meta name="theme-color" content="#7952b3">

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }
    </style>

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }
    </style>

</head>

<body>

    <header>
        <nav class="navbar navbar-expand-md navbar-dark static-top bg-dark">
            <div class="container-fluid">
                <a id="HomeButton" class="navbar-brand">Accueil</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
                    aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarCollapse">
                    <ul class="navbar-nav me-auto mb-2 mb-md-0">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page"
                                href="https://drive.google.com/drive/u/0/folders/1c-JQAoCTkghOKlCidAvJ9TFJnsNyRLU-"
                                target="_blank">Formations</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/presentation/d/1J4sFVXm4jWiC7UkG16FcnbhZHsfU6CmQ4Dkw2kujVek/edit"
                                target="_blank">KPI</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/presentation/d/1m3Ig7H7l1St9_aOSxtORQyIC0ToNaAwOL5reley7l-A/edit"
                                target="_blank">Apps Script</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/presentation/d/1YkrMD8QVMI-Rb_HLrysoh-L5TL8uj77rDwPQ04mYuL4/edit"
                                target="_blank">Compléments</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/presentation/d/1cBYK5kyuVp2TQjIEYb_ZMdot_NdFRZn_-k0eaAkFcrM/edit"
                                target="_blank">Implémentation</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/document/d/1EQM9gxvAhs2h9pNtqt7NlzLJFMZPmcsWJZKxesU7P9M/edit"
                                target="_blank">clasp</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link"
                                href="https://docs.google.com/document/d/1BwIl0HbwClp3k426Y34PeAHR_4uXuMUKHpNjQAF-NLw/edit"
                                target="_blank">Makefile</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div id="Home">

            <div class="b-example-divider"></div>
            <div id="myCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="0" class="active"
                        aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="1"
                        aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#myCarousel" data-bs-slide-to="2"
                        aria-label="Slide 3"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                            <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/angle.jfif" width=100% height=100% style="opacity: 0.6;">
                        </svg>

                        <div class="container">
                            <div class="carousel-caption text-start">
                                <h1 style="color:#8E3232;">Dashboard KPI</h1>
                                <p style="color: #404040;">Implémentation de KPI accessibles à travers le Dashboard KPI.
                                </p>
                                <p><a class="btn btn-lg btn-primary" target="_blank"
                                        href="https://docs.google.com/spreadsheets/d/1b9x3zqSVIc8Q1lE8vuf2Bu-vBgRAGkEDqT14F3QR4uA/edit#gid=0">
                                        <svg
                                            xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            fill="currentColor" class="bi bi-speedometer2" viewBox="0 0 16 16">
                                            <path
                                                d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z" />
                                            <path fill-rule="evenodd"
                                                d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z" />
                                        </svg> &nbsp; Accéder au dashboard</a></p>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                            <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/view.jfif" width=100% height=100% style="opacity: 0.3;">
                        </svg>

                        <div class="container">
                            <div class="carousel-caption">
                                <h1 style="color:#8E3232;">Recevoir les KPI par mail</h1>
                                <p style="color: #404040;"></p>
                                <form>
                                    <h1 class="h3 mb-3 fw-normal">Entrez votre adresse mail</h1>
                                
                                    <div class="form-floating">
                                      <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com">
                                      <label for="floatingInput">Adresse mail</label>
                                    </div>

                                    <button class="w-100 btn btn-lg btn-primary" type="submit">Envoyer</button>
                                  </form>
                            </div>
                        </div>
                    </div>
                    <div class="carousel-item">
                        <svg class="bd-placeholder-img" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true" preserveAspectRatio="xMidYMid slice" focusable="false">
                            <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/water.jfif" width=100% height=100% style="opacity: 0.5;">
                        </svg>

                        <div class="container">
                            <div class="carousel-caption text-end">
                                <h1 style="color:#8E3232;">Préparer le CA</h1>
                                <p style="color: #404040;">Générer un Slides regroupant les KPI dans le <a href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy" target="_blank">Drive du Pôle Qualité</a>.
                                </p>
                                <p><a id="genSlides" class="btn btn-lg btn-primary">Créer les slides</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
            
            <div class="container py-5" id="hanging-icons">
                <h2 class="pb-2 border-bottom">Guides</h2><br><br>
                <div class="container-overview" style="display: block;
                margin-left: auto;
                margin-right: auto; text-align: center; align-items: center;">

                    <!-- Three columns of text below the carousel -->
                    <div class="row">
                        <div class="col-lg-4">
                            <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                                xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140"
                                preserveAspectRatio="xMidYMid slice" focusable="false">
                                <title>Placeholder</title>
                                <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/sausages.jfif">
                            </svg>
                            <br><br>
                            <h2>KPI</h2>
                            <p>Quelques étapes à suivre pour implémenter un nouveau KPI intégré à l'ensemble des fonctionnalités disponibles.</p>
                            <p><a class="btn btn-warning"
                                    href="https://docs.google.com/presentation/d/1cBYK5kyuVp2TQjIEYb_ZMdot_NdFRZn_-k0eaAkFcrM/edit#slide=id.gd1022c80b3_0_1">Plus
                                    d'informations &raquo;</a></p>
                        </div><!-- /.col-lg-4 -->
                        <div class="col-lg-4">
                            <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                                xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 250x250"
                                preserveAspectRatio="xMidYMid slice" focusable="false">
                                <title>Placeholder</title>
                                <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/lilypad.jfif">
                            </svg>
                            <br><br>
                            <h2>Catégories de KPI</h2>
                            <p>Quelques étapes à suivre pour ajouter une catégorie/modifier les catégories de KPI.</p>
                            <p><a class="btn btn-warning"
                                    href="https://docs.google.com/presentation/d/1cBYK5kyuVp2TQjIEYb_ZMdot_NdFRZn_-k0eaAkFcrM/edit#slide=id.gd37cb0e5a6_0_0">Plus
                                    d'informations &raquo;</a></p>
                        </div><!-- /.col-lg-4 -->
                        <div class="col-lg-4">
                            <svg class="bd-placeholder-img rounded-circle" width="140" height="140"
                                xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: 140x140"
                                preserveAspectRatio="xMidYMid slice" focusable="false">
                                <title>Placeholder</title>
                                <image href="https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/documentation/local-singlePageApp/img/maple.jfif">
                            </svg>
                            <br><br>
                            <h2>Fichiers de données</h2>
                            <p>Quelques indications sur la démarche à suivre pour ajouter un nouveau Sheet de données.</p>
                            <p><a class="btn btn-warning" href="https://docs.google.com/presentation/d/1cBYK5kyuVp2TQjIEYb_ZMdot_NdFRZn_-k0eaAkFcrM/edit#slide=id.gd11bd4c405_0_0">Plus d'informations &raquo;</a></p>
                        </div><!-- /.col-lg-4 -->
                    </div><!-- /.row -->
                </div>
                <h2 class="pb-2 border-bottom">Documentation</h2>
                <div class="row g-5 py-5">
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-sort-down" viewBox="0 0 16 16">
                                <path
                                    d="M3.5 2.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 11.293V2.5zm3.5 1a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                            </svg>
                        </div>
                        <div>
                            <h2>dataTables.js</h2>
                            <p>Fichier contenant des fonctions qui permettent de créer des tables de données à
                                représenter
                                sous forme de graphes.</p>
                            <a id="dataTables" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="dataTables.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-emoji-smile-upside-down" viewBox="0 0 16 16">
                                <path d="M8 1a7 7 0 1 0 0 14A7 7 0 0 0 8 1zm0-1a8 8 0 1 1 0 16A8 8 0 0 1 8 0z" />
                                <path
                                    d="M4.285 6.433a.5.5 0 0 0 .683-.183A3.498 3.498 0 0 1 8 4.5c1.295 0 2.426.703 3.032 1.75a.5.5 0 0 0 .866-.5A4.498 4.498 0 0 0 8 3.5a4.5 4.5 0 0 0-3.898 2.25.5.5 0 0 0 .183.683zM7 9.5C7 8.672 6.552 8 6 8s-1 .672-1 1.5.448 1.5 1 1.5 1-.672 1-1.5zm4 0c0-.828-.448-1.5-1-1.5s-1 .672-1 1.5.448 1.5 1 1.5 1-.672 1-1.5z" />
                            </svg>
                        </div>
                        <div>
                            <h2>main.js</h2>
                            <p>Fichier principal regroupant les fonctions de génération de KPI ainsi que les fonctions
                                qui
                                sont appelées au travers des différents menus.</p>
                            <a id="Main" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="Main.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-graph-up" viewBox="0 0 16 16">
                                <path fill-rule="evenodd"
                                    d="M0 0h1v15h15v1H0V0zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5z" />
                            </svg>
                        </div>
                        <div>
                            <h2>charts.js</h2>
                            <p>Fichier contenant des fonctions qui permettent de créer des graphes à partir de tables de
                                données.</p>
                            <a id="charts" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="charts.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                </div>
                <div class="row g-5 py-5">
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-palette" viewBox="0 0 16 16">
                                <path
                                    d="M8 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm4 3a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM5.5 7a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z" />
                                <path
                                    d="M16 8c0 3.15-1.866 2.585-3.567 2.07C11.42 9.763 10.465 9.473 10 10c-.603.683-.475 1.819-.351 2.92C9.826 14.495 9.996 16 8 16a8 8 0 1 1 8-8zm-8 7c.611 0 .654-.171.655-.176.078-.146.124-.464.07-1.119-.014-.168-.037-.37-.061-.591-.052-.464-.112-1.005-.118-1.462-.01-.707.083-1.61.704-2.314.369-.417.845-.578 1.272-.618.404-.038.812.026 1.16.104.343.077.702.186 1.025.284l.028.008c.346.105.658.199.953.266.653.148.904.083.991.024C14.717 9.38 15 9.161 15 8a7 7 0 1 0-7 7z" />
                            </svg>
                        </div>
                        <div>
                            <h2>parameters.js</h2>
                            <p>Fichier de configuration contenant l'ensemble des paramètres d'affichage et de
                                configuration
                                utilisés dans les autres
                                fichiers.</p>
                            <a id="parameters" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="parameters.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-puzzle" viewBox="0 0 16 16">
                                <path
                                    d="M3.112 3.645A1.5 1.5 0 0 1 4.605 2H7a.5.5 0 0 1 .5.5v.382c0 .696-.497 1.182-.872 1.469a.459.459 0 0 0-.115.118.113.113 0 0 0-.012.025L6.5 4.5v.003l.003.01c.004.01.014.028.036.053a.86.86 0 0 0 .27.194C7.09 4.9 7.51 5 8 5c.492 0 .912-.1 1.19-.24a.86.86 0 0 0 .271-.194.213.213 0 0 0 .039-.063v-.009a.112.112 0 0 0-.012-.025.459.459 0 0 0-.115-.118c-.375-.287-.872-.773-.872-1.469V2.5A.5.5 0 0 1 9 2h2.395a1.5 1.5 0 0 1 1.493 1.645L12.645 6.5h.237c.195 0 .42-.147.675-.48.21-.274.528-.52.943-.52.568 0 .947.447 1.154.862C15.877 6.807 16 7.387 16 8s-.123 1.193-.346 1.638c-.207.415-.586.862-1.154.862-.415 0-.733-.246-.943-.52-.255-.333-.48-.48-.675-.48h-.237l.243 2.855A1.5 1.5 0 0 1 11.395 14H9a.5.5 0 0 1-.5-.5v-.382c0-.696.497-1.182.872-1.469a.459.459 0 0 0 .115-.118.113.113 0 0 0 .012-.025L9.5 11.5v-.003a.214.214 0 0 0-.039-.064.859.859 0 0 0-.27-.193C8.91 11.1 8.49 11 8 11c-.491 0-.912.1-1.19.24a.859.859 0 0 0-.271.194.214.214 0 0 0-.039.063v.003l.001.006a.113.113 0 0 0 .012.025c.016.027.05.068.115.118.375.287.872.773.872 1.469v.382a.5.5 0 0 1-.5.5H4.605a1.5 1.5 0 0 1-1.493-1.645L3.356 9.5h-.238c-.195 0-.42.147-.675.48-.21.274-.528.52-.943.52-.568 0-.947-.447-1.154-.862C.123 9.193 0 8.613 0 8s.123-1.193.346-1.638C.553 5.947.932 5.5 1.5 5.5c.415 0 .733.246.943.52.255.333.48.48.675.48h.238l-.244-2.855zM4.605 3a.5.5 0 0 0-.498.55l.001.007.29 3.4A.5.5 0 0 1 3.9 7.5h-.782c-.696 0-1.182-.497-1.469-.872a.459.459 0 0 0-.118-.115.112.112 0 0 0-.025-.012L1.5 6.5h-.003a.213.213 0 0 0-.064.039.86.86 0 0 0-.193.27C1.1 7.09 1 7.51 1 8c0 .491.1.912.24 1.19.07.14.14.225.194.271a.213.213 0 0 0 .063.039H1.5l.006-.001a.112.112 0 0 0 .025-.012.459.459 0 0 0 .118-.115c.287-.375.773-.872 1.469-.872H3.9a.5.5 0 0 1 .498.542l-.29 3.408a.5.5 0 0 0 .497.55h1.878c-.048-.166-.195-.352-.463-.557-.274-.21-.52-.528-.52-.943 0-.568.447-.947.862-1.154C6.807 10.123 7.387 10 8 10s1.193.123 1.638.346c.415.207.862.586.862 1.154 0 .415-.246.733-.52.943-.268.205-.415.39-.463.557h1.878a.5.5 0 0 0 .498-.55l-.001-.007-.29-3.4A.5.5 0 0 1 12.1 8.5h.782c.696 0 1.182.497 1.469.872.05.065.091.099.118.115.013.008.021.01.025.012a.02.02 0 0 0 .006.001h.003a.214.214 0 0 0 .064-.039.86.86 0 0 0 .193-.27c.14-.28.24-.7.24-1.191 0-.492-.1-.912-.24-1.19a.86.86 0 0 0-.194-.271.215.215 0 0 0-.063-.039H14.5l-.006.001a.113.113 0 0 0-.025.012.459.459 0 0 0-.118.115c-.287.375-.773.872-1.469.872H12.1a.5.5 0 0 1-.498-.543l.29-3.407a.5.5 0 0 0-.497-.55H9.517c.048.166.195.352.463.557.274.21.52.528.52.943 0 .568-.447.947-.862 1.154C9.193 5.877 8.613 6 8 6s-1.193-.123-1.638-.346C5.947 5.447 5.5 5.068 5.5 4.5c0-.415.246-.733.52-.943.268-.205.415-.39.463-.557H4.605z" />
                            </svg>
                        </div>
                        <div>
                            <h2>features.js</h2>
                            <p>Fichier contenant des fonctions implémentant des fonctionnalités supplémentaires
                                d'enregistrement, de génération de slides...</p>
                            <a id="features" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="features.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                    <div class="col-md-4 d-flex align-items-start">
                        <div class="icon-square bg-light text-dark flex-shrink-0 me-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-tools" viewBox="0 0 16 16">
                                <path
                                    d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z" />
                            </svg>
                        </div>
                        <div>
                            <h2>tools.js</h2>
                            <p>Fichier contenant des fonctions de bas niveau facilitant l'implémentation des KPI et
                                augmentant
                                le confort du développeur.</p>
                            <a id="tools" class="btn btn-primary">
                                Consulter la doc
                            </a>
                            <a id="tools.js" class="btn btn-success">
                                Consulter le code
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="p-3 bg-white" id="navFiles" style="width: 250px; display: none; float: left;">
            <ul id="navbarF" class="list-unstyled ps-0">
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#main-collapse" aria-expanded="true">
                        <a class="navMain">main</a>
                    </button>
                    <div class="collapse show" id="main-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#autoSaveKPI" class="navMain">autoSaveKPI</a></a>
                            </li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#displayKPI" class="navMain">displayKPI</a></a>
                            </li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#generateKPI" class="navMain">generateKPI</a></a>
                            </li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#installTrigger"
                                        class="navMain">installTrigger</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#prepCA" class="navMain">prepCA</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#saveKPI" class="navMain">saveKPI</a></a></li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#features-collapse" aria-expanded="true">
                        <a class="navfeatures">features</a>
                    </button>
                    <div class="collapse show" id="features-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#generateSlides"
                                        class="navfeatures">generateSlides</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#saveOnDrive"
                                        class="navfeatures">saveOnDrive</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#sendMail" class="navfeatures">sendMail</a></a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="border-top my-3"></li>
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#dataTables-collapse" aria-expanded="true">
                        <a class="navdataTables">dataTables</a>
                    </button>
                    <div class="collapse show" id="dataTables-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#conversionRate"
                                        class="navdataTables">conversionRate</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#numberOfMissions"
                                        class="navdataTables">numberOfMissions</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#performance"
                                        class="navdataTables">performance</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#totalDistribution"
                                        class="navdataTables">totalDistribution</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#turnoverDistribution"
                                        class="navdataTables">turnoverDistribution</a></a></li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#charts-collapse" aria-expanded="true">
                        <a class="navcharts">charts</a>
                    </button>
                    <div class="collapse show" id="charts-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#addOptions" class="navcharts">addOptions</a></a>
                            </li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#createChart"
                                        class="navcharts">createChart</a></a></li>
                        </ul>
                    </div>
                </li>

                <li class="border-top my-3"></li>
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#tools-collapse" aria-expanded="true">
                        <a class="navtools">tools</a>
                    </button>
                    <div class="collapse show" id="tools-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#addHTMLLine"
                                        class="navtools">addHTMLLine</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#convertChart"
                                        class="navtools">convertChart</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#displayLoadingScreen"
                                        class="navtools">displayLoadingScreen</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#extractSheetData"
                                        class="navtools">extractSheetData</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#manuallyGetRowNumber"
                                        class="navtools">manuallyGetRowNumber</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#measureTime"
                                        class="navtools">measureTime</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#prcnt" class="navtools">prcnt</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#sameMonth" class="navtools">sameMonth</a></a>
                            </li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#uniqueValues"
                                        class="navtools">uniqueValues</a></a></li>
                            <li><span class="nav-item-type type-function">F</span><a href="#"
                                    class="link-dark rounded"><a href="#userQuery" class="navtools">userQuery</a></a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse"
                        data-bs-target="#parameters-collapse" aria-expanded="true">
                        <a class="navparameters">parameters</a>
                    </button>
                    <div class="collapse show" id="parameters-collapse">
                        <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#ADDRESSES" class="navparameters">ADDRESSES</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#COLORS" class="navparameters">COLORS</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#DIMS" class="navparameters">DIMS</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#ETAT_ETUDE" class="navparameters">ETAT_ETUDE</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#ETAT_PROSP" class="navparameters">ETAT_PROSP</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#HEADS" class="navparameters">HEADS</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#MONTH_LIST" class="navparameters">MONTH_LIST</a></a></li>
                            <li><span class="nav-item-type type-member">M</span><a href="#" class="link-dark rounded"><a
                                        href="#TITLES" class="navparameters">TITLES</a></a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>

        <div id="Doc">
            <div id="chartsDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Génération de graphes à partir de tables de données</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient des fonctions qui permettent de créer des graphes à partir de <a href="https://developers.google.com/apps-script/reference/charts/data-table?hl=en">DataTables</a> obtenues grâce aux fonctions du fichier <code><a href="#" class="navdataTables">dataTables.js</a></code>.</li>
                            <li>En pratique seule la fonction <code>createChart</code> sera utilisée, elle prend plusieurs arguments détaillés ci-dessous.</li>
                            <li>Le premier est un enum qui s'écrit de la manière suivante : <code>CHART_TYPE.</code> suivi de <code>PIE</code>, <code>COLUMN</code> ou <code>LINE</code> en fonction du type de graphe désiré.</li>
                            <li>Les options contiennent tous des valeurs par défaut détaillées ci-dessous, pour imposer des options différentes il suffit de passer un 4e argument à <code>createChart</code> sous la forme d'un Object, par exemple <code>createChart(CHART_TYPE.PIE, dataTable, "A Pie Chart", {colors: ["#D66BA0"]})</code>.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">
                            </dl>
                        </div>
                        <h3 class="subsection-title">Methods</h3>
                        <div class="section-method">
                            <h4 class="name" id="addOptions"><span class="type-signature"></span>addOptions<span
                                    class="signature">(chartBuilder, title, options)</span><span
                                    class="type-signature"></span>
                            </h4>
                            <div class="description">
                                Ajouter des options à un chartBuilder (appelée par createChart). <br/>
                                Liste des options disponibles :
                                <ul>
                                    <li><code>colors</code> : Couleurs des graphes sous forme d'Array, valeur par défaut : <code>Object.values(COLORS)</code>.</li>
                                    <li><code>percent</code> : Booléen qui fixe l'intervalle des ordonnées à [0, 100] (correspondant alors à des pourcentages), valeur par défaut : <code>false</code>.</li>
                                    <li><code>hticks</code> : Array correspondant aux valeurs indiquées sur l'axe des abscisses, ces valeurs sont déterminées automatiquement par défaut.</li>
                                    <li><code>vticks</code> : Array correspondant aux valeurs indiquées sur l'axe des ordonnées, ces valeurs sont déterminées automatiquement par défaut.</li>
                                </ul>
                            </div>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>chartBuilder</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>ChartBuilder</code></span>
                                        </td>
                                        <td class="description last">
                                            ChartBuilder utilisé.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>title</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Titre du graphe.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>options</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <dl class="details">
                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navcharts.js" href="#">charts.js</a>, <a class="navcharts.js"
                                                href="#line36">line
                                                36</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>

                        <div class="section-method">
                            <h4 class="name" id="createChart"><span class="type-signature"></span>createChart<span
                                    class="signature">(chartType, dataTable, title, options)</span><span
                                    class="type-signature">
                                    &rarr; {Chart}</span></h4>
                            <div class="description">
                                Creation d'un graphe au type <a href="https://developers.google.com/apps-script/reference/charts/chart?hl=en">Chart</a>. <br/>
                                Liste des options disponibles :
                                <ul>
                                    <li><code>colors</code> : Couleurs des graphes sous forme d'Array, valeur par défaut : <code>Object.values(COLORS)</code>.</li>
                                    <li><code>percent</code> : Booléen qui fixe l'intervalle des ordonnées à [0, 100] (correspondant alors à des pourcentages), valeur par défaut : <code>false</code>.</li>
                                    <li><code>hticks</code> : Array correspondant aux valeurs indiquées sur l'axe des abscisses, ces valeurs sont déterminées automatiquement par défaut.</li>
                                    <li><code>vticks</code> : Array correspondant aux valeurs indiquées sur l'axe des ordonnées, ces valeurs sont déterminées automatiquement par défaut.</li>
                                </ul>
                            </div>

                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>chartType</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Enum</code></span>
                                        </td>
                                        <td class="description last">
                                            Type du graphe (Pie, Line, Column).
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>dataTable</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a href="https://developers.google.com/apps-script/reference/charts/data-table-builder?hl=en">DataTable</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Table de données à utiliser.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>title</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Titre du graphe.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>options</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
                                        </td>
                                    </tr>
                                </tbody>
                            </table> <br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Chart</code></span>
                                    </dd>
                                </dl>
                                <div class="param-desc">
                                    - Graphe complet.
                                </div>
                            </div>
                            <dl class="details">
                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navcharts.js" href="#">charts.js</a>, <a class="navcharts.js"
                                                href="#line14">line
                                                14</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <br/><br/>
                    </article>
                </section>
            </div>

            <div id="charts.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">charts.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        
        // Creating charts using a data table as input
        
        // Creating a chart using one of the different builders among PieChart, ColumnChart and LineChart
        /**
         * Creation d'un graphe au type Chart.
         * @param {Enum} chartType - Type du graphe (Pie, Line, Column).
         * @param {DataTable} dataTable - Table de données à utiliser.
         * @param {string} title - Titre du graphe.
         * @param {Object} options - Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
         * @returns {Chart} - Graphe complet.
         */
        function createChart(chartType, dataTable, title, options = {}) {
            Logger.log(`Creating chart ${title} of type ${Object.keys(CHART_TYPE)[Object.values(CHART_TYPE).indexOf(chartType)]} with ${!options ? "no option" : `options : ${Object.entries(options)}`}.`);
            try {
                if (chartType === CHART_TYPE.COLUMN) {
                    return addOptions(Charts.newColumnChart().setDataTable(dataTable), title, options);
                } else if (chartType === CHART_TYPE.PIE) {
                    return addOptions(Charts.newPieChart().setDataTable(dataTable), title, options);
                } else if (chartType === CHART_TYPE.LINE) {
                    return addOptions(Charts.newLineChart().setDataTable(dataTable).setOption('curveType', 'function').setOption('pointSize', 10).setOption('pointShape', 'diamond'), title, options);
                }
            } catch (e) {
                Logger.log(`Could not create graph for info : ${title}, error : ${e}`);
            }
        }
        
        // Add options to a chartBuilder
        /** 
         * Ajouter des options à un chartBuilder (appelée par createChart).
         * @param {ChartBuilder} chartBuilder - ChartBuilder utilisé.
         * @param {string} title - Titre du graphe.
         * @param {Object} options - Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
         */
        function addOptions(chartBuilder, title, options) {
            return chartBuilder
                .setOption('legend', {
                    textStyle: {
                        font: 'roboto',
                        fontSize: 11
                    }
                })
                .setOption('colors', options.colors || Object.values(COLORS))
                .setOption('vAxis.minValue', (options.percent || false) ? 0 : 'automatic')
                .setOption('vAxis.maxValue', (options.percent || false) ? 100 : 'automatic')
                .setOption('hAxis.ticks', options.hticks || 'auto')
                .setOption('vAxis.ticks', options.vticks || 'auto')
                .setTitle(title)
                .setDimensions(options.width || DIMS.width, options.height || DIMS.height)
                .build();
        }
        </code></pre>
                    </article>
                </section>




            </div>

            <div id="dataTablesDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Extraction de données sous forme de tables</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient des fonctions qui permettent de créer des <a href="https://developers.google.com/apps-script/reference/charts/data-table?hl=en">DataTables</a> à partir des Arrays d'Objects de données.</li>
                            <li>En pratique on recode souvent une fonction pour chaque KPI, ajoutez la à la fin de ce fichier.</li>
                            <li>Dans cette documentation sont présentés quelques exemples types de KPI qui sont facilement déclinables en remplaçant un seul champ.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">


                            </dl>
                        </div>
                        <h3 class="subsection-title">Methods</h3>
                        <div class="section-method">
                            <h4 class="name" id="conversionRate"><span class="type-signature"></span>conversionRate<span
                                    class="signature">(key, data)</span><span class="type-signature"> &rarr;
                                    {Array}</span>
                            </h4>
                            <div class="description">
                                Calcul du taux de conversion décliné selon les différentes catégories présentes dans une
                                colonne
                                spécifiée (uniquement pour le suivi de la prospection).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line92">line 92</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera évalué le taux de conversion.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table> <br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Array</code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="numberOfMissions"><span
                                    class="type-signature"></span>numberOfMissions<span class="signature">(key,
                                    data)</span><span class="type-signature"> &rarr; {Array}</span>
                            </h4>
                            <div class="description">
                                Calcul du nombre d'études selon les valeurs présente dans une colonne du fichier étudié.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line71">line 71</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera compté le nombre d'études.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Array</code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant
                                    et tableau des valeurs à indiquer selon l'axe horizontal.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="performance"><span class="type-signature"></span>performance<span
                                    class="signature">(key, data)</span><span class="type-signature"> &rarr;
                                    {Array}</span>
                            </h4>
                            <div class="description">
                                Calcul du CA et du nombre d'études selon les valeurs présentes dans une colonne du
                                fichier
                                de
                                suivi de la prospection (transposable au suivi d'étude en remplaçant caPot en prix).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line49">line 49</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera évaluée la performance de la JE.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Array</code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant
                                    et tableau des valeurs à indiquer selon l'axe vertical.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="totalDistribution"><span
                                    class="type-signature"></span>totalDistribution<span class="signature">(key,
                                    data)</span><span class="type-signature"> &rarr; {DataTable}</span>
                            </h4>
                            <div class="description">
                                Calcul de la réparition des contacts selon la colonne dont le nom est spécifié.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line11">line 11</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera effectuée la répartition.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code><a
                                                    href="https://developers.google.com/apps-script/reference/charts/data-table-builder?hl=en">DataTable</a></code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="turnoverDistribution"><span
                                    class="type-signature"></span>turnoverDistribution<span class="signature">(key,
                                    data)</span><span class="type-signature"> &rarr; {DataTable}</span></h4>
                            <div class="description">
                                Calcul de la répartition du CA selon les valeurs présentes dans une colonne du fichier
                                de
                                suivi
                                de la prospection (transposable au suivi d'étude en remplaçant caPot en prix).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line29">line 29</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera évaluée la répartition du CA.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code><a
                                                    href="https://developers.google.com/apps-script/reference/charts/data-table-builder?hl=en">DataTable</a></code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="turnoverDistributionBinary"><span
                                    class="type-signature"></span>turnoverDistributionBinary<span
                                    class="signature">(key,
                                    data)</span><span class="type-signature"> &rarr; {DataTable}</span></h4>
                            <div class="description">
                                Calcul de la répartition du CA selon les valeurs présentes dans une colonne du fichier
                                de
                                suivi
                                de la prospection (transposable au suivi de la prospection en remplaçant prix par
                                caPot).
                                On suppose que la colonne contient des cases à cocher (deux catégories uniquement).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navdataTables.js" href="#">dataTables.js</a>, <a
                                                class="navdataTables.js" href="#line114">line 114</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de la colonne selon laquelle sera évaluée la répartition du CA.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données d'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code><a
                                                    href="https://developers.google.com/apps-script/reference/charts/data-table-builder?hl=en">DataTable</a></code></span>
                                    </dd>-
                                    Table des données permettant de créer le graphe correspondant.
                                </dl>
                            </div>
                        </div>
                    </article>
                </section>
            </div>

            <div id="dataTables.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">dataTables.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        
        // Extracting data from an array of Objects and returning a dataTable
        
        /**
         * Calcul de la réparition des contacts selon la colonne dont le nom est spécifié.
         * @param {string} key Nom de la colonne selon laquelle sera effectuée la répartition.
         * @param {Array} data Données d'entrée.
         * @returns {DataTable} Table des données permettant de créer le graphe correspondant.
         */
        function totalDistribution(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, key);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Proportion des contacts");
            // Rows
            uniqueValues(key, data).forEach(type => {
                dataTable.addRow([type, data.filter(row => row[key] == type).length / data.length]);
            });
            return dataTable;
        }
        
        /**
         * Calcul de la répartition du CA selon les valeurs présentes dans une colonne du fichier de suivi de la prospection (transposable au suivi d'étude en remplaçant caPot en prix).
         * @param {string} key Nom de la colonne selon laquelle sera évaluée la répartition du CA.
         * @param {Array} data Données d'entrée.
         * @returns {DataTable} Table des données permettant de créer le graphe correspondant.
         */
        function turnoverDistribution(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, key);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Proportion du CA");
            // Rows
            let ca = data.reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0);
            uniqueValues(key, data).forEach(currentType => {
                dataTable.addRow([currentType, prcnt(data.filter(row => row[key] == currentType).reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0), ca)]);
            });
            return dataTable;
        }
        
        /**
         * Calcul du CA et du nombre d'études selon les valeurs présentes dans une colonne du fichier de suivi de la prospection (transposable au suivi d'étude en remplaçant caPot en prix).
         * @param {string} key Nom de la colonne selon laquelle sera évaluée la performance de la JE.
         * @param {Array} data Données d'entrée.
         * @returns {Array} Table des données permettant de créer le graphe correspondant
         * et tableau des valeurs à indiquer selon l'axe vertical.
         */
        function performance(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, key);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Nombre d'études");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "CA (en milliers d'€)");
            // Rows
            let maxTick = 0;
            uniqueValues(key, data).forEach(currentType => {
                maxTick = Math.max(maxTick, data.filter(row => row[key] == currentType).length, parseInt(data.filter(row => row[key] == currentType).reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0) / 1000, 10) + 1);
                dataTable.addRow([currentType, data.filter(row => row[key] == currentType).length, data.filter(row => row[key] == currentType).reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0) / 1000]);
            });
            return [dataTable, Array.from(Array(maxTick + 1).keys())];
        }
        
        /**
         * Calcul du nombre d'études selon les valeurs présente dans une colonne du fichier étudié.
         * @param {string} key Nom de la colonne selon laquelle sera compté le nombre d'études.
         * @param {Array} data Données d'entrée.
         * @returns {Array} Table des données permettant de créer le graphe correspondant
         * et tableau des valeurs à indiquer selon l'axe horizontal.
         */
         function numberOfMissions(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.NUMBER, key);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Nombre d'études");
            // Rows
            let lowerBound = Math.min(...data.map(row => parseInt(row[key], 10))),
                higherBound = Math.max(...data.map(row => parseInt(row[key], 10)));
            let values = Array.from(Array(higherBound - lowerBound + 1).keys()).map(number => number + lowerBound);
            values.forEach(number => {
                dataTable.addRow([number, data.filter(row => parseInt(row[HEADS.durée], 10) == number).length])
            });
            return [dataTable, values];
        }
        
        /**
         * Calcul du taux de conversion décliné selon les différentes catégories présentes dans une colonne spécifiée (uniquement pour le suivi de la prospection).
         * @param {string} key Nom de la colonne selon laquelle sera évalué le taux de conversion.
         * @param {Array} data Données d'entrée.
         * @returns {Array} Table des données permettant de créer le graphe correspondant.
         */
        function conversionRate(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, key);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Nombre de contacts");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Taux de conversion global");
            // Rows
            uniqueValues(key, data).forEach(function (type) {
                let objFiltered = data.filter(row => row[key] == type),
                    conversionRate = prcnt(objFiltered.filter(row => row[HEADS.état] == ETAT_PROSP.etude).length, objFiltered.length);
                dataTable.addRow([type, objFiltered.length, conversionRate]);
            });
            return dataTable;
        }
        
        /**
         * Calcul de la répartition du CA selon les valeurs présentes dans une colonne du fichier de suivi de la prospection (transposable au suivi de la prospection en remplaçant prix par caPot).
         * On suppose que la colonne contient des cases à cocher (deux catégories uniquement).
         * @param {string} key Nom de la colonne selon laquelle sera évaluée la répartition du CA.
         * @param {Array} data Données d'entrée.
         * @returns {DataTable} Table des données permettant de créer le graphe correspondant.
         */
         function turnoverDistributionBinary(key, data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, `${key}/Hors ${key}`);
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Proportion du CA");
            // Rows
            let ca = data.reduce((sum, row) => sum += parseInt(row[HEADS.prix], 10) || 0, 0);
            dataTable.addRow([key, prcnt(data.filter(row => row[key] || false).reduce((sum, row) => sum += parseInt(row[HEADS.prix], 10) || 0, 0), ca)]);
            dataTable.addRow([`Hors ${key}`, prcnt(data.filter(row => !(row[key] || false)).reduce((sum, row) => sum += parseInt(row[HEADS.prix], 10) || 0, 0), ca)]);
            return dataTable;
        }
        
        // Répartition des contacts par mois
        function contacts(data) {
            let dataTable = Charts.newDataTable(),
                conversionChart = [];
            // Columns : month, all 4 states a mission can go through
            dataTable.addColumn(Charts.ColumnType.STRING, "Mois");
            Object.values(ETAT_PROSP).forEach(function (state) {
                dataTable.addColumn(Charts.ColumnType.NUMBER, state);
            });
            // Rows
            MONTH_LIST.forEach(function (month) {
                let dataRow = [`${MONTH_NAMES[month.month]} ${month.year}`],
                    conversionChartRow = [];
                Object.values(ETAT_PROSP).forEach(function (state) {
                    // Counting first every contact who find themselves in a more advanced state than state
                    let val = data.filter(row => sameMonth(row, month) &amp;&amp; Object.values(ETAT_PROSP).indexOf(row[HEADS.état]) >= Object.values(ETAT_PROSP).indexOf(state)).length;
                    if (state == ETAT_PROSP.devis || state == ETAT_PROSP.negoc) {
                        // In both cases we forgot to count ppl to whom we sent a devis but who didn't convert it into a mission
                        val += data.filter(row => sameMonth(row, month) &amp;&amp; Object.values(ETAT_PROSP_BIS).includes(row[HEADS.état]) &amp;&amp; row[HEADS.devis]).length
                    } else if (state == ETAT_PROSP.rdv) {
                        // We must also count contacts who didn't lead to a mission
                        val += data.filter(row => sameMonth(row, month) &amp;&amp; Object.values(ETAT_PROSP_BIS).includes(row[HEADS.état])).length
                    }
                    conversionChartRow.push(val);
                    dataRow.push(val);
                });
                conversionChart.push(conversionChartRow);
                dataTable.addRow(dataRow);
            });
            return [dataTable, conversionChart];
        }
        
        // Taux de conversion global
        function conversionRateOverTime(conversionChart) {
            let dataTable = Charts.newDataTable();
            // Columns : month, all 3 conversion rates
            dataTable.addColumn(Charts.ColumnType.STRING, "Mois");
            dataTable.addColumn(Charts.ColumnType.NUMBER, `Taux de conversion global`);
            // Rows
            MONTH_LIST.forEach(function (month, idx) {
                dataTable.addRow([`${MONTH_NAMES[month.month]} ${month.year}`, prcnt(conversionChart[idx][1], conversionChart[idx][0]) / 100 * prcnt(conversionChart[idx][2], conversionChart[idx][1]) / 100 * prcnt(conversionChart[idx][3], conversionChart[idx][2])]);
            });
            return dataTable;
        }
        
        // Taux de conversion par étape
        function conversionRateByType(conversionChart) {
            let dataTable = Charts.newDataTable();
            // Columns : month, all 3 conversion rates
            dataTable.addColumn(Charts.ColumnType.STRING, "Étape de la conversion");
            dataTable.addColumn(Charts.ColumnType.NUMBER, `Taux de conversion entre ${ETAT_PROSP.rdv} et ${ETAT_PROSP.devis}`);
            dataTable.addColumn(Charts.ColumnType.NUMBER, `Taux de conversion entre ${ETAT_PROSP.devis} et ${ETAT_PROSP.negoc}`);
            dataTable.addColumn(Charts.ColumnType.NUMBER, `Taux de conversion entre ${ETAT_PROSP.negoc} et ${ETAT_PROSP.etude}`);
            // Rows
            dataTable.addRow([`${ETAT_PROSP.rdv} -> ${ETAT_PROSP.devis}`, prcnt(conversionChart.reduce((acc, val) => acc += val[1], 0), conversionChart.reduce((acc, val) => acc += val[0], 0))]);
            dataTable.addRow([`${ETAT_PROSP.devis} -> ${ETAT_PROSP.negoc}`, prcnt(conversionChart.reduce((acc, val) => acc += val[2], 0), conversionChart.reduce((acc, val) => acc += val[1], 0))]);
            dataTable.addRow([`${ETAT_PROSP.negoc} -> ${ETAT_PROSP.etude}`, prcnt(conversionChart.reduce((acc, val) => acc += val[3], 0), conversionChart.reduce((acc, val) => acc += val[2], 0))]);
            return dataTable;
        }
        
        // CA potentiel et CA signé
        function turnover(data) {
            let dataTable = Charts.newDataTable();
            // Columns : month, potential turnover and contractualized turnover
            dataTable.addColumn(Charts.ColumnType.STRING, "Mois");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "CA sur étude potentielle");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "CA sur étude signée");
            // Rows
            MONTH_LIST.forEach(function (month) {
                let ca_pot = 0,
                    ca_sig = 0;
                data.filter(row => sameMonth(row, month)).forEach(function (row) {
                    // /!\ row[HEADS.confiance] isn't actually a percentage since we used method getValues on the range instead of getDisplayValues
                    // Potential turnover is the sum of every expected gain
                    ca_pot += (parseInt(row[HEADS.caPot], 10) * row[HEADS.confiance]) || 0;
                    // Contractualized turnover is computed based on missions who are state ETAT_PROSP.study
                    if (row[HEADS.état] == ETAT_PROSP.etude) {
                        ca_sig += parseInt(row[HEADS.caPot], 10) || 0;
                    }
                    Logger.log(row);
                });
                dataTable.addRow([`${MONTH_NAMES[month.month]} ${month.year}`, ca_pot, ca_sig]);
            });
            return dataTable;
        }
        
        // Répartition des prix des études
        function priceRange(data, lowerBound, higherBound, nbrRanges) {
            let dataTable = Charts.newDataTable();
            // Columns : number of missions for different price ranges
            dataTable.addColumn(Charts.ColumnType.STRING, "Intervalle de prix");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Nombre d'études");
            // Rows : creating multiple ranges of prices
            let width = parseInt((higherBound - lowerBound) / nbrRanges, 10),
                priceRanges = Array.from(Array(nbrRanges).keys()).map((_, idx) => lowerBound + idx * width);
            priceRanges.forEach(price => {
                dataTable.addRow([`${price} - ${price + width}`, data.filter(row => (price &lt;= row[HEADS.prix] &amp;&amp; row[HEADS.prix] &lt; price + width)).length]);
            });
            return dataTable;
        }
        
        // Proportion du CA venant de la prospection
        function prospectionTurnover(data) {
            let dataTable = Charts.newDataTable();
            // Columns
            dataTable.addColumn(Charts.ColumnType.STRING, "Prospection ou non");
            dataTable.addColumn(Charts.ColumnType.NUMBER, "Proportion du CA");
            // Rows
            let ca = data.reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0);
            dataTable.addRow(["Prospection", prcnt(data.filter(row => !([CONTACT_TYPE.site, CONTACT_TYPE.spontané].includes(row[HEADS.typeContact]))).reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0), ca)]);
            dataTable.addRow(["Hors prospection", prcnt(data.filter(row => [CONTACT_TYPE.site, CONTACT_TYPE.spontané].includes(row[HEADS.typeContact])).reduce((sum, row) => sum += parseInt(row[HEADS.caPot], 10) || 0, 0), ca)]);
            return dataTable;
        }
        </code></pre>
                    </article>
                </section>




            </div>

            <div id="featuresDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Fonctionnalités supplémentaires</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient des fonctions qui permettent d'implémenter différentes fonctionnalités.</li>
                            <li>Ces fonctions sont appelées dans l'Object qui est return par la fonction <code>generateKPI</code> du fichier <code><a href="#" class="navMain">main.js</a></code>.</li>
                            <li>Si vous souhaitez ajouter d'autres fonctionnalités aux KPI, ajoutez des fonctions correspondantes à ce fichier et ajoutez des éléments à l'Object return par la fonction <code>generateKPI</code> pour les utiliser.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">




                            </dl>
                        </div>

                        <h3 class="subsection-title">Methods</h3>
                        <div class="section-method">
                            <h4 class="name" id="generateSlides"><span class="type-signature"></span>generateSlides<span
                                    class="signature">(template, chartImages, folderId)</span><span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Génération d'un fichier Slides à partir d'un template et d'un ensemble d'images,
                                enregistré dans le dossier spécifié (par défaut dans <a
                                    href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy">Pôle
                                    Qualité -> KPI -> KPI archivés</a>).
                            </div>
                            <dl class="details">



                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navfeatures.js" href="#">features.js</a>, <a
                                                class="navfeatures.js" href="#line57">line
                                                57</a>
                                        </li>
                                    </ul>
                                </dd>

                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>template</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            ID du fichier Slides qui servira de template.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>chartImages</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Object dont les valeurs sont des Array de <a
                                                href="https://developers.google.com/apps-script/reference/base/blob">blobs</a>
                                            (titrés) correspondant aux images
                                            des graphes.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>folderId</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            ID du dossier Drive dans lequel seront enregistrées les slides.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="saveOnDrive"><span class="type-signature"></span>saveOnDrive<span
                                    class="signature">(imageBlobs, folderId)</span><span class="type-signature"></span>
                            </h4>
                            <div class="description">
                                Enregistrement des graphes (sous format .png) dans un sous dossier daté à la date
                                d'aujourd'hui
                                du dossier spécifié
                                (par défaut dans <a
                                    href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy">Pôle
                                    Qualité -> KPI -> KPI archivés</a>).
                            </div>
                            <dl class="details">



                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navfeatures.js" href="#">features.js</a>, <a
                                                class="navfeatures.js" href="#line28">line
                                                28</a>
                                        </li>
                                    </ul>
                                </dd>

                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>imageBlobs</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Object dont les valeurs sont des Array de <a
                                                href="https://developers.google.com/apps-script/reference/base/blob">blobs</a>
                                            correspondant aux images des
                                            graphes.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>folderId</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            ID du fichier de destination.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="sendMail"><span class="type-signature"></span>sendMail<span
                                    class="signature">(address, htmlOutput, subject, attachments)</span><span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Envoi des graphes (en pièces jointes, sous format .png) à l'adresse mail spécifiée.
                            </div>
                            <dl class="details">



                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navfeatures.js" href="#">features.js</a>, <a
                                                class="navfeatures.js" href="#line12">line
                                                12</a>
                                        </li>
                                    </ul>
                                </dd>

                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>address</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Adresse mail de destination.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>htmlOutput</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a
                                                        href="https://developers.google.com/apps-script/reference/html/html-output?hl=en">HtmlOutput</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Contenu Html à faire parvenir.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>subject</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Objet du mail.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>attachments</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Pièces jointes du mail (sous forme d'Object car les KPI sont groupés par
                                            catégorie).
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </article>
                </section>
            </div>

            <div id="features.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">features.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        
        // Features aiming at interfacing the generation of KPI with other tools from the G-Suite
        
        /**
         * Envoi des graphes (en pièces jointes, sous format .png) à l'adresse mail spécifiée.
         * @param {string} address - Adresse mail de destination.
         * @param {HtmlOutput} htmlOutput - Contenu Html à faire parvenir.
         * @param {string} subject - Objet du mail.
         * @param {Object} attachments - Pièces jointes du mail (sous forme d'Object car les KPI sont groupés par catégorie).
         */
        function sendMail(address, htmlOutput, subject, attachments) {
            let msgHtml = htmlOutput.getContent(),
                msgPlain = htmlOutput.getContent().replace(/\&lt;br\/\>/gi, '\n').replace(/(&lt;([^>]+)>)/ig, "");
            GmailApp.sendEmail(address, subject, msgPlain, {
                htmlBody: msgHtml,
                attachments: [].concat(...Object.values(attachments))
            });
            ui.alert("Envoi des diagrammes par mail", `Les diagrammes ont été envoyés par mail à : ${adress}.`, ui.ButtonSet.OK);
        }
        
        /**
         * Enregistrement des graphes (sous format .png) dans un sous dossier daté à la date d'aujourd'hui du dossier spécifié
         * (par défaut dans Pôle Qualité -> KPI -> KPI archivés).
         * @param {Object} imageBlobs - Object dont les valeurs sont des Array de blobs correspondant aux images des graphes.
         * @param {string} folderId - ID du fichier de destination.
         */
        function saveOnDrive(imageBlobs, folderId) {
            try {
                displayLoadingScreen("Enregistrement des images sur le Drive..");
                // Folder will be dated with current date
                let today = new Date();
                today = `KPI ${(today.getDate() &lt; 9) ? "0" : ""}${today.getDate()}/${(today.getMonth() &lt; 9) ? "0" : ""}${today.getMonth() + 1}/${today.getFullYear()}`;
                let folder = DriveApp.getFolderById(folderId).createFolder(today);
                Object.values(imageBlobs).forEach(arr => {
                    arr.forEach(f => {
                        folder.createFile(f);
                    });
                });
                let confirm = HTML_CONTENT.saveConfirm(folder.getUrl());
                ui.showModelessDialog(confirm, "KPIs enregistrés !");
            } catch (e) {
                Logger.log(`Erreur lors de l'enregistrement des images sur le Drive : ${e}.`);
                ui.alert("Erreur lors de l'enregistrement des images sur le Drive.");
            }
        }
        
        // NB1: many values are hardcoded here, do not put them in the parameters file, these are not parameters and won't come to change
        // NB2: many suppositions are made on the template (and on its predefined layout), this won't work on any template
        /**
         * Génération d'un fichier Slides à partir d'un template et d'un ensemble d'images,
         * enregistré dans le dossier spécifié (par défaut dans Pôle Qualité -> KPI -> KPI archivés).
         * @param {string} template - ID du fichier Slides qui servira de template.
         * @param {Object} chartImages - Object dont les valeurs sont des Array de blobs (titrés) correspondant aux images des graphes.
         * @param {string} folderId - ID du dossier Drive dans lequel seront enregistrées les slides.
         */
        function generateSlides(template, chartImages, folderId) {
            displayLoadingScreen("Génération des slides..");
        
            // Today's date
            let today = new Date();
            today = `Point KPI du ${(today.getDate() &lt; 9) ? "0" : ""}${today.getDate()}/${(today.getMonth() &lt; 9) ? "0" : ""}${today.getMonth() + 1}/${today.getFullYear()}`;
            let presentation = SlidesApp.openById(DriveApp.getFileById(template).makeCopy(today, DriveApp.getFolderById(folderId)).getId()),
                chartlayout = presentation.getLayouts()[8],
                sectionLayout = presentation.getLayouts()[6];
        
            // First slide
            let currentSlide = presentation.appendSlide(SlidesApp.PredefinedLayout.SECTION_HEADER);
            currentSlide.getShapes()[0].getText().setText(today);
            currentSlide.getShapes()[1].getText().setText("Aubin Tchoï, Directeur Qualité 022");
            presentation.getSlides()[0].remove();
        
            let box = currentSlide.insertShape(SlidesApp.ShapeType.RECTANGLE).setLeft(650).setTop(140).setWidth(300).setHeight(380),
                text;
            box.getBorder().getLineFill().setSolidFill('#FFFFFF');
            box.getFill().setSolidFill('#FFFFFF');
        
            Object.keys(chartImages).forEach(key => {
                // New slide to present the section
                if (chartImages[key].length > 0) {
                    currentSlide = presentation.appendSlide(sectionLayout);
                    currentSlide.getShapes()[1].getText().setText(today);
                    currentSlide.getShapes()[2].getText().setText("Aubin Tchoï, Directeur Qualité 022");
                    currentSlide.getShapes()[0].getText().setText(TITLES[key]);
                }
                chartImages[key].forEach(img => {
                    // New slide
                    currentSlide = presentation.appendSlide(chartlayout);
                    // White box to hide PEP's logo in the bottom right corner
                    currentSlide.insertShape(box);
                    // Inserting the image
                    currentSlide.insertImage(img).alignOnPage(SlidesApp.AlignmentPosition.CENTER).setTop(375 - DIMS.height / 2);
                    // Writing a title
                    text = currentSlide.getShapes()[0].getText().setText(img.getName());
                });
            });
            box.remove();
        }
        </code></pre>
                    </article>
                </section>




            </div>

            <div id="MainDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Fichier main</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient les fonctions qui sont liées à un trigger (menu ou horaire) ainsi que la fonction principale <code>generateKPI</code>.</li>
                            <li>Cette fonction est organisée de la manière suivante : on fetch les données des différents scripts sous la forme d'Arrays d'Objects (<code>extractSheetData</code>), on génère les <code>Charts</code> des KPI dans les listes de l'Object <code>charts</code>
                                puis on les convertis en images dans l'Object <code>attachments</code>. Dans le return on utilise ces données dans des appels aux différentes fonctionnalités codées dans le fichier <code><a href="#" class="navfeatures">features.js</a></code>.</li>
                            <li>Les KPI sont stockés dans des Objects <code>charts</code> et <code>attachments</code> afin de pouvoir les regrouper par thématique.</li>
                            <li>A chaque nouvelle thématique sera ajoutée une ligne du display ainsi qu'une slide du Point KPI généré automatiquement. Le contenu de la ligne (identique au titre de la slide) est encodé dans l'Object <code>TITLES</code> du fichier <code><a href="#TITLES" class="navparameters">parameters.js</a></code>.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">


                            </dl>
                        </div>
                        <h3 class="subsection-title">Methods</h3>
                        <div class="section-method">
                            <h4 class="name" id="autoSaveKPI"><span class="type-signature"></span>autoSaveKPI<span
                                    class="signature">()</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Enregistre les graphes sous forme d'images (au format .png) dans
                                <a href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy">Pôle
                                    Qualité -> KPI -> KPI archivés.</a>
                                Reliée à un trigger mensuel (le 11 du mois).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line307">line
                                                307</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="displayKPI"><span class="type-signature"></span>displayKPI<span
                                    class="signature">()</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Affichage des KPI dans le dashboard. Reliée à l'item "Affichage des KPI" dans le menu
                                "KPI".
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line270">line
                                                270</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="generateKPI"><span class="type-signature"></span>generateKPI<span
                                    class="signature">()</span><span class="type-signature"> &rarr; {Object}</span></h4>
                            <div class="description">
                                Fonction main - Génération des KPI, log régulièrement le temps écoulé entre chaque
                                étape.
                                Dans le return vous disposez des graphes dans les Objects charts (type Chart) et
                                attachments
                                (type <a href="https://developers.google.com/apps-script/reference/base/blob">Blob</a>)
                                ainsi que dans le htmlOutput.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line38">line
                                                38</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Object</code></span>
                                    </dd>-
                                    Méthodes display, save, mail, slides qui correspondent chacune à une fonctionnalité
                                    associée
                                    aux KPI.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="installTrigger"><span class="type-signature"></span>installTrigger<span
                                    class="signature">()</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Fonction qui à l'exécution crée le trigger de sauvegarde automatique (a besoin d'être
                                exécuté
                                une seule fois).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line25">line
                                                25</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="prepCA"><span class="type-signature"></span>prepCA<span
                                    class="signature">()</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Crée un fichier Slides (il s'agit du Point KPI) contenant les KPI regroupés par
                                catégorie,
                                il se trouvera dans <a
                                    href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy">Pôle
                                    Qualité -> KPI -> KPI archivés</a>. Reliée à l'item "Préparation du CA"
                                dans le menu "KPI".
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line316">line
                                                316</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="saveKPI"><span class="type-signature"></span>saveKPI<span
                                    class="signature">()</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Enregistre les graphes sous forme d'images (au format .png) dans le dossier spécifié
                                (par
                                défaut
                                dans <a
                                    href="https://drive.google.com/drive/u/0/folders/1dPi0dht-q_rI8fUmheA1j861huYPPcAy">Pôle
                                    Qualité -> KPI -> KPI archivés</a>)
                                puis les envoie par mail à l'adresse spécifiée. Reliée à l'item "Enregistrement des KPI"
                                dans le
                                menu "KPI".
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navMain.js" href="#">main.js</a>, <a class="navMain.js"
                                                href="#line279">line
                                                279</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>

                        </div>
                    </article>
                </section>
            </div>

            <div id="Main.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">main.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        /* Certains commentaires sont en anglais, d'autres en français.
        Si vous vous contenez à une modification en surface du code (ajout d'un KPI par exemple),
        vous devriez voir essentiellement des commentaires en français. */
        
        // Main file (triggers + main functions for KPI)
        
        /* ----- Triggers ----- */
        /**
         * Fonction exécutée à l'ouverture du dashboard, permet la création du menu 'KPI'.
         * @ignore
         */
        function onOpen() {
          ui.createMenu('KPI')
            .addItem("Affichage des KPI", "displayKPI")
            .addItem("Enregistrement des KPI", "saveKPI")
            .addSeparator()
            .addItem("Préparation du CA", "prepCA")
            .addToUi();
        }
        
        /**
         * Fonction qui à l'exécution crée le trigger de sauvegarde automatique (a besoin d'être exécuté une seule fois).
         */
        function installTrigger() {
          ScriptApp.newTrigger("autoSaveKPI")
            .timeBased()
            .onMonthDay(11)
            .create();
        }
        
        /* ------ KPI ----- */
        /**
         * Fonction main - Génération des KPI, log régulièrement le temps écoulé entre chaque étape.
         * Dans le return vous disposez des graphes dans les Objects charts (type Chart) et attachments (type Blob) ainsi que dans le htmlOutput.
         * @returns {Object} Méthodes display, save, mail, slides qui correspondent chacune à une fonctionnalité associée aux KPI.
         */
        function generateKPI() {
          // Initializing the time counter
          let currentTime = new Date();
        
          displayLoadingScreen("Chargement des KPI..");
        
          // Initialization (names in franglish because why not)
          /**
           * Données sous forme d'Array d'Object
           * (1 ligne correspond à une ligne du Sheets, les clés correspondent aux champs du header indiqués dans HEADS)
           */
          let dataProspection = extractSheetData(ADDRESSES.prospectionId, ADDRESSES.prospectionName, {
              data: {
                x: 4,
                y: 2
              },
              header: {
                x: 1,
                y: 2
              },
              trustColumn: 4
            }).filter(row => row[HEADS.premierContact] != ""),
            dataEtudes = extractSheetData(ADDRESSES.etudesId, ADDRESSES.etudesName, {
              data: {
                x: 5,
                y: 3
              },
              header: {
                x: 1,
                y: 3
              },
              trustColumn: 3
            }).filter(row => row[HEADS.état] != ETAT_ETUDE.sanSuite);
        
          currentTime = measureTime(currentTime, "extract data from the two sheets");
        
          /**
           * Output qui sera affiché lors du display (type HtmlOutput).
           */
          let htmlOutput = HTML_CONTENT.display,
            /** 
             * Contenu Html du mail qui peut être envoyé sur demande dans le menu "Enregistrement des KPI".
             */
            htmlMail = HTML_CONTENT.mail,
            /**
             * Object regroupant les blobs des graphes (au format .png) en différentes catégories décrites par les clés de l'Object.
             */
            attachments = {},
            /**
             * Object regroupant les graphes (au type Chart) en différentes catégories décrites par les clés de l'Object.
             */
            charts = {
              summary: [],
              contactTypology: [],
              competitiveness: [],
              sizeComparison: [],
              contributions: []
            };
        
          currentTime = measureTime(currentTime, "load the HTML content");
        
        
          // ----- BILAN PROSPECTION -----
        
          // KPI : Contacts par mois
          let [dataTable, conversionChart] = contacts(dataProspection); // conversionChart is a 2D array : [month][number of contact in a given state]
          charts.summary.push(createChart(CHART_TYPE.COLUMN, dataTable, "Contacts", {
            colors: COLORS_OFFICE
          }));
        
          // KPI : Taux de conversion global par mois
          dataTable = conversionRateOverTime(conversionChart);
          charts.summary.push(createChart(CHART_TYPE.LINE, dataTable, "Taux de conversion global", {
            colors: [COLORS.burgundy]
          }));
        
          // KPI : Taux de conversion entre chaque étape
          dataTable = conversionRateByType(conversionChart);
          charts.summary.push(createChart(CHART_TYPE.COLUMN, dataTable, "Taux de conversion sur chaque étape", {
            colors: [COLORS.burgundy],
            percent: true
          }));
        
          // KPI : CA
          /* dataTable = turnover(dataProspection);
          charts.summary.push(createColumnChart(dataTable, Object.values(COLORS), "Chiffre d'affaires", DIMS)); */
        
        
          // ----- TYPOLOGIE DES CONTACTS -----
        
          // KPI : Répartition des contacts par type
          dataTable = totalDistribution(HEADS.typeContact, dataProspection);
          charts.contactTypology.push(createChart(CHART_TYPE.PIE, dataTable, "Type de contact", {
            colors: COLORS_OFFICE
          }));
        
          // KPI : Taux de conversion par type de contact
          dataTable = conversionRate(HEADS.typeContact, dataProspection);
          charts.contactTypology.push(createChart(CHART_TYPE.COLUMN, dataTable, "Taux de conversion par type de contact", {
            colors: COLORS_DUO,
            percent: true
          }));
        
          // KPI : Répartition des contacts par domaine de compétence
          dataTable = totalDistribution(HEADS.domaine, dataProspection.filter(row => row[HEADS.domaine] != ""));
          charts.contactTypology.push(createChart(CHART_TYPE.PIE, dataTable, "Répartition des contacts par domaine de compétence", {
            colors: COLORS_OFFICE
          }));
        
        
          // ----- CONCURRENCE AVEC D'AUTRES JE
        
          // KPI : Contacts qui sont en lien avec d'autres JE
          /*let [dataTable, conversionConcurrenceChart] = contacts(dataProspection.filter(row => row[HEADS.concurrence] || false));
          charts.competitiveness.push(createChart(CHART_TYPE.COLUMN, dataTable, "Contacts en lien avec d'autres JE")); */
        
          // KPI : Taux de conversion en concurrence
          /* dataTable = conversionRateByType(conversionConcurrenceChart);
          charts.competitiveness.push(createChart(CHART_TYPE.COLUMN, dataTable, "Taux de conversion sur chaque étape (en situation de concurrence)", {
            colors: [COLORS.burgundy],
            percent: true
          })); */
        
        
          // ----- PERFORMANCE SELON LA TAILLE DES ETUDES -----
        
          // KPI : Nombre d'étude pour différents intervalles de prix
          dataTable = priceRange(dataEtudes.filter(row => row[HEADS.prix] != ""), 500, 4500, 8);
          charts.sizeComparison.push(createChart(CHART_TYPE.COLUMN, dataTable, "Nombre d'études par tranche de prix (en €)", {
            colors: [COLORS.burgundy]
          }));
        
          // KPI : Nombre d'étude pour différents intervalles de prix
          let [dataTablebis, ticks] = numberOfMissions(HEADS.JEH, dataEtudes.filter(row => row[HEADS.JEH] != ""));
          charts.sizeComparison.push(createChart(CHART_TYPE.COLUMN, dataTablebis, "Nombre d'études par nombre de JEHs", {
            colors: [COLORS.burgundy],
            hticks: ticks
          }));
        
          // KPI : Nombre d'étude pour différents intervalles de prix
          [dataTablebis, ticks] = numberOfMissions(HEADS.durée, dataEtudes.filter(row => row[HEADS.durée] != ""));
          charts.sizeComparison.push(createChart(CHART_TYPE.COLUMN, dataTablebis, "Nombre d'études par durée d'étude (en nombre de semaines)", {
            colors: [COLORS.burgundy],
            hticks: ticks
          }));
        
        
          // ----- MESURE DES DIFFERENTES CONTRIBUTIONS AU CA -----
        
          // KPI : nombre d'études, CA par type d'entreprise
          [dataTable, ticks] = performance(HEADS.secteur, dataProspection.filter(row => row[HEADS.état] == ETAT_PROSP.etude).filter(row => row[HEADS.secteur] != ""));
          charts.contributions.push(createChart(CHART_TYPE.COLUMN, dataTable, "Performance par type d'entreprise", {
            colors: COLORS_DUO,
            vticks: ticks
          }));
        
          // KPI : Proportion du CA venant de chaque type d'entreprise
          dataTable = turnoverDistribution(HEADS.typeEntreprise, dataProspection.filter(row => row[HEADS.état] == ETAT_PROSP.etude).filter(row => row[HEADS.secteur] != ""));
          charts.contributions.push(createChart(CHART_TYPE.PIE, dataTable, "Proportion du CA venant de chaque type d'entreprise", {
            colors: COLORS_OFFICE
          }));
        
          // KPI : nombre d'études, CA par secteur
          [dataTable, ticks] = performance(HEADS.secteur, dataProspection.filter(row => row[HEADS.état] == ETAT_PROSP.etude).filter(row => row[HEADS.secteur] != ""));
          charts.contributions.push(createChart(CHART_TYPE.COLUMN, dataTable, "Performance par secteur", {
            colors: COLORS_DUO,
            vticks: ticks
          }));
        
          // KPI : Proportion du CA venant de chaque secteur
          dataTable = turnoverDistribution(HEADS.secteur, dataProspection.filter(row => row[HEADS.état] == ETAT_PROSP.etude).filter(row => row[HEADS.secteur] != ""));
          charts.contributions.push(createChart(CHART_TYPE.PIE, dataTable, "Proportion du CA venant de chaque secteur", {
            colors: COLORS_OFFICE
          }));
        
          // KPI : Proportion du CA due aux alumni
          dataTable = turnoverDistributionBinary(HEADS.alumni, dataEtudes);
          charts.contributions.push(createChart(CHART_TYPE.PIE, dataTable, "Proportion du CA due aux alumni", {
            colors: [COLORS.pine, COLORS.silverPink]
          }));
        
          // KPI : Proportion du CA venant de la prospection
          dataTable = prospectionTurnover(dataProspection.filter(row => row[HEADS.état] == ETAT_PROSP.etude));
          charts.contributions.push(createChart(CHART_TYPE.PIE, dataTable, "Proportion du CA venant de la prospection", {
            colors: [COLORS.pine, COLORS.silverPink]
          }));
        
          currentTime = measureTime(currentTime, "create the charts");
        
          // Adding the charts to the htmlOutput and the list of attachments
          Object.keys(charts).forEach(key => {
            // Adding a line that describe the category of KPI
            if (charts[key].length > 0) {
              addHTMLLine(key, htmlOutput);
            }
            attachments[key] = [];
            // Converting every chart
            charts[key].forEach(c => {
              convertChart(c, c.getOptions().get("title"), htmlOutput, attachments[key]);
            });
          });
        
          currentTime = measureTime(currentTime, "convert the charts");
        
          // Returning functions within an Object for later use, all functions are manually decorated with an execution time logger
          return {
            display: function () {
              let initialTime = new Date();
              ui.showModalDialog(htmlOutput, "KPI");
              measureTime(initialTime, "display the charts");
            },
            save: function (folderId = ADDRESSES.driveId) {
              let initialTime = new Date();
              saveOnDrive(attachments, folderId);
              measureTime(initialTime, "save the charts");
            },
            mail: function (address) {
              let initialTime = new Date();
              sendMail(address, htmlMail, "KPI", attachments);
              measureTime(initialTime, "mail the charts");
            },
            slides: function () {
              let initialTime = new Date();
              generateSlides(ADDRESSES.slidesTemplate, attachments, folderId = ADDRESSES.driveId);
              measureTime(initialTime, "generate the slides");
            }
          }
        }
        
        /**
         * Affichage des KPI dans le dashboard. Reliée à l'item "Affichage des KPI" dans le menu "KPI".
         */
        function displayKPI() {
          let KPI = generateKPI();
          KPI.display();
        }
        
        /**
         * Enregistre les graphes sous forme d'images (au format .png) dans le dossier spécifié (par défaut dans Pôle Qualité -> KPI -> KPI archivés)
         * puis les envoie par mail à l'adresse spécifiée. Reliée à l'item "Enregistrement des KPI" dans le menu "KPI".
         */
        function saveKPI() {
          // Prompts and alerts should be made before any time-consuming operation (to make it so users can enter any required information and then leave)
          let mailResults = ui.alert("Envoi des diagrammes par mail", "Souhaitez vous recevoir les diagrammes par mail ?", ui.ButtonSet.YES_NO) == ui.Button.YES,
            saveResults = ui.alert("Enregistrement des images sur le Drive", "Souhaitez vous enregistrer les images sur le Drive ?", ui.ButtonSet.YES_NO) == ui.Button.YES,
            folderId = saveResults ? userQuery({
              title: "Enregistrement des images sur le Drive",
              query: "Entrez l'id du dossier de destination :",
              incorrectInput: "L'ID entré est invalide, veuillez recommencer."
            }) : "",
            mailAdress = mailResults ? userQuery({
              title: "Envoi des diagrammes par mail",
              query: "Entrez l'adresse mail de destination :"
            }) : "",
            KPI = generateKPI();
        
          if (mailResults) {
            KPI.mail(mailAdress);
          }
          if (saveResults) {
            KPI.save(folderId);
          }
          KPI.display();
        }
        
        /**
         * Enregistre les graphes sous forme d'images (au format .png) dans Pôle Qualité -> KPI -> KPI archivés.
         * Reliée à un trigger mensuel (le 11 du mois).
         */
        function autoSaveKPI() {
          let KPI = generateKPI();
          KPI.save();
        }
        
        /**
         * Crée un fichier Slides (il s'agit du Point KPI) contenant les KPI regroupés par catégorie,
         * il se trouvera dans Pôle Qualité -> KPI -> KPI archivés. Reliée à l'item "Préparation du CA" dans le menu "KPI".
         */
        function prepCA() {
          let KPI = generateKPI();
          KPI.slides();
          KPI.save();
        }
        </code></pre>
                    </article>
                </section>




            </div>

            <div id="parametersDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Liste des paramètres</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient un ensemble de paramètres constants.</li>
                            <li>Il s'agit de paramètres d'affichage (dimensions et couleurs des graphes, contenu affiché dans le display et par mail)
                                et de paramètres d'accès (adresses des Sheets, du template Slides, contenu exact des headers et de certains champs).</li>
                            <li>Les mois affichés dans les KPI ayant pour abscisses les mois sont exactement ceux de l'Object <code><a href="#MONTH_LIST">MONTH_LIST</a></code>.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">


                            </dl>
                        </div>
                        <h3 class="subsection-title">Members</h3>
                        <div class="section-members">
                            <h4 class="name" id="ADDRESSES"><span class="type-signature">(constant)
                                </span>ADDRESSES<span class="type-signature"></span></h4>
                            <div class="description">
                                IDs et noms de sheets.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line86">line 86</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="CHART_TYPE"><span class="type-signature">(constant)
                                </span>CHART_TYPE<span class="type-signature"> :Symbol</span></h4>
                            <div class="description">
                                Enum utilisé pour identifier les différents types de graphes.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line251">line 251</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Type:</h5>
                            <ul>
                                <li>
                                    <span class="param-type"><code>Symbol</code></span>
                                </li>
                            </ul>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="COLORS"><span class="type-signature">(constant) </span>COLORS<span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Couleurs des graphes.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line13">line 13</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="CONTACT_TYPE"><span class="type-signature">(constant)
                                </span>CONTACT_TYPE<span class="type-signature"></span></h4>
                            <div class="description">
                                Différents types de contact.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line141">line 141</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="DIMS"><span class="type-signature">(constant) </span>DIMS<span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Dimensions des graphes.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line34">line 34</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="ETAT_ETUDE"><span class="type-signature">(constant)
                                </span>ETAT_ETUDE<span class="type-signature"></span></h4>
                            <div class="description">
                                Différents états possible d'une étude (dans le suivi des études).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line156">line 156</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="ETAT_PROSP"><span class="type-signature">(constant)
                                </span>ETAT_PROSP<span class="type-signature"></span></h4>
                            <div class="description">
                                Différents états possible dans la prospection (dans le suivi de la prospection).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line121">line 121</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="ETAT_PROSP_BIS"><span class="type-signature">(constant)
                                </span>ETAT_PROSP_BIS<span class="type-signature"></span></h4>
                            <div class="description">
                                États correspondant à un contact qui n'a pas abouti sur une étude (dans le suivi de la
                                prospection).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line132">line 132</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="HEADS"><span class="type-signature">(constant) </span>HEADS<span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Header des fichiers de données.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line99">line 99</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="HTML_CONTENT"><span class="type-signature">(constant)
                                </span>HTML_CONTENT<span class="type-signature"></span></h4>
                            <div class="description">
                                Contenu HTML (mail, affichage des KPI et écran de chargement).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class = "navparameters.js" href="#line52">line 52</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="IMGS"><span class="type-signature">(constant) </span>IMGS<span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Liens vers différentes images/gif.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line43">line 43</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="MONTH_LIST"><span class="type-signature">(constant)
                                </span>MONTH_LIST<span class="type-signature"></span></h4>
                            <div class="description">
                                Index des mois à représenter.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line172">line 172</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="MONTH_NAMES"><span class="type-signature">(constant)
                                </span>MONTH_NAMES<span class="type-signature"></span></h4>
                            <div class="description">
                                Manière dont les mois sont écrits.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line242">line 242</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                        <div class="section-members">
                            <h4 class="name" id="TITLES"><span class="type-signature">(constant) </span>TITLES<span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Titres des slides de transition.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navparameters.js" href="#">parameters.js</a>, <a
                                                class="navparameters.js" href="#line72">line 72</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                        </div>
                    </article>
                </section>
            </div>

            <div id="parameters.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">parameters.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        
        // Parameters : do not put here hardcoded values that are not parameters
        
        const ui = SpreadsheetApp.getUi(),
        
            /* ----- Paramètres d'affichage ----- */
            /** 
             * Couleurs des graphes.
             * @constant
             * @readonly
             */
            COLORS = Object.freeze({
                plum: "#934683",
                wildOrchid: "#D66BA0",
                silverPink: "#C9ADA1",
                pine: "#72A98F",
                blueBell: "#A997DF",
                burgundy: "#8E3232",
                gold: "#FFBE2B",
                grey: "#404040",
                lightGrey: "#A29386"
            }),
            COLORS_OFFICE = Object.freeze([
                "#4472C4", "#954F72", "#C00000", "#ED7D31", "#FFC000", "#70AD47", "#264478", "#592F44", "#730000",
                "#9E480E", "#997300", "#43682B", "#698ED0", "#B16C8E", "#FF0101", "#F1975A", "#FFCD33", "#8CC168"
            ]),
            COLORS_DUO = Object.freeze(["#8e3232", "#561E1E"]),
            /** 
             * Dimensions des graphes.
             * @constant
             * @readonly
             */
            DIMS = {
                width: 1000,
                height: 400
            },
            /** 
             * Liens vers différentes images/gif.
             * @constant
             * @readonly
             */
            IMGS = {
                loadingScreen: "https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/images/loadingScreen.gif",
                thumbsUp: "https://raw.githubusercontent.com/aubin-tchoi/Polkali/main/images/thumbsUp.png"
            },
            /** 
             * Contenu HTML (mail, affichage des KPI et écran de chargement).
             * @constant
             * @readonly
             */
            HTML_CONTENT = {
                display: HtmlService
                    .createHtmlOutput(`&lt;span style='font-size: 12pt;'> &lt;span style="font-family: 'roboto', sans-serif;">&amp;nbsp; &amp;nbsp; Voici quelques KPI représentant l'activité de la JE :&lt;/span> &lt;/span>`)
                    .setWidth(1015)
                    .setHeight(515),
                mail: HtmlService.createHtmlOutput(`&lt;span style='font-size: 12pt;'> &lt;span style="font-family: 'roboto', sans-serif;">&amp;nbsp; &amp;nbsp; Bonjour, &lt;br/>&lt;br/>Voici les KPI portant sur la prospection.&lt;br/> &lt;br/>Bonne journée !&lt;/span> &lt;/span>`),
                saveConfirm: (url) => HtmlService
                    .createHtmlOutput(`&lt;span style='font-size: 12pt;'> &lt;span style="font-family: 'roboto', sans-serif;">Les KPIs ont été enregistrés, pouce pour ouvrir le lien (cliquez sur Boris).&lt;br/>&lt;br/> &amp;nbsp; &amp;nbsp; La bise.&lt;/span>&lt;/span>&lt;p style="text-align:center;">&lt;a href=${url} target="_blank">&lt;img src="${IMGS.thumbsUp}" alt="Thumbs up" width="130" height="131">&lt;/a>&lt;/p>`)
                    .setHeight(235)
                    .setWidth(600),
                loadingScreen: HtmlService
                    .createHtmlOutput(`&lt;img src="${IMGS.loadingScreen}" alt="Loading" width="442" height="249">`)
                    .setWidth(450)
                    .setHeight(280)
            },
            /** 
             * Titres des slides de transition.
             * @constant
             * @readonly
             */
            TITLES = {
                summary: "Bilan",
                contactTypology: "Typologie des contacts",
                competitiveness: "Compétitivité face aux autres JE",
                sizeComparison: "Performance sur différentes tailles d'étude",
                contributions: "Mesure des différentes contributions au CA"
            },
        
            /* ----- Paramètres d'accès ----- */
            /**  
             * IDs et noms de sheets.
             * @constant
             * @readonly
             */
            ADDRESSES = Object.freeze({
                prospectionId: "1lJhJuZxUt_8_mVLXe5tazXPrb2Z3wr0M49rho974sNQ",
                prospectionName: "Suivi",
                etudesId: "1gmJLAKvUOYFeS32raOiSTYiE_ozr7YSk26Y0t0blm04",
                etudesName: "Suivi",
                driveId: "1dPi0dht-q_rI8fUmheA1j861huYPPcAy",
                slidesTemplate: "15WdicqHVF8LtOPrlwdM5iD1_qKh7YPaM15hrGGVbVzU"
            }),
            /**  
             * Header des fichiers de données.
             * @constant
             * @readonly
             */
            HEADS = Object.freeze({
                entreprise: "Entreprise",
                premierContact: "Premier contact",
                typeContact: "Type de contact",
                état: "État",
                devis: "Devis réalisé",
                caPot: "Prix potentiel de l'étude  € (HT)",
                confiance: "Pourcentage de confiance à la conversion en réelle étude",
                prix: "Prix en € (HT)",
                durée: "Durée (semaines)",
                alumni: "Alumni",
                JEH: "Nb JEH",
                concurrence: "Autres JE en concurrence",
                domaine: "Domaine de compétence",
                secteur: "Secteur du Client",
                typeEntreprise: "Type d'entreprise"
            }),
            /**  
             * Différents états possible dans la prospection (dans le suivi de la prospection).
             * @constant
             * @readonly
             */
            ETAT_PROSP = Object.freeze({
                rdv: "Premier RDV réalisé",
                devis: "Devis rédigé et envoyé",
                negoc: "En négociation",
                etude: "Etude obtenue"
            }),
            /** 
             * États correspondant à un contact qui n'a pas abouti sur une étude (dans le suivi de la prospection).
             * @constant
             * @readonly
             */
            ETAT_PROSP_BIS = Object.freeze({
                sansSuite: "Sans suite",
                aRelancer: "A relancer",
            }),
            /** 
             * Différents types de contact.
             * @constant
             * @readonly
             */
            CONTACT_TYPE = Object.freeze({
                quali: "Prospection quali ",
                spontané: "Contact spontané",
                classique: "Prospection classique ",
                recommandé: "Recommandé ",
                ao: "Appel d'offre",
                site: "Site",
                redirectionQuali: "Redirection suite à la prospection quali ",
                redirectionClassique: "Redirection suite à la prospection classique "
            }),
            /** 
             * Différents états possible d'une étude (dans le suivi des études).
             * @constant
             * @readonly
             */
            ETAT_ETUDE = Object.freeze({
                negoc: "En négociation",
                redac: "En rédaction",
                enAttente: "En attente",
                enCours: "En cours",
                terminée: "Terminée",
                cloturée: "Clôturée",
                sanSuite: "Sans suite"
            }),
        
            /* ----- Paramètres portant sur les mois ----- */
            /** 
             * Index des mois à représenter.
             * @constant
             * @readonly
             */
            MONTH_LIST = Object.freeze([{
                    month: 1,
                    year: 2020
                },
                {
                    month: 2,
                    year: 2020
                },
                {
                    month: 3,
                    year: 2020
                },
                {
                    month: 4,
                    year: 2020
                },
                {
                    month: 5,
                    year: 2020
                },
                {
                    month: 6,
                    year: 2020
                },
                {
                    month: 7,
                    year: 2020
                },
                {
                    month: 8,
                    year: 2020
                },
                {
                    month: 9,
                    year: 2020
                },
                {
                    month: 10,
                    year: 2020
                },
                {
                    month: 11,
                    year: 2020
                },
                {
                    month: 0,
                    year: 2021
                },
                {
                    month: 1,
                    year: 2021
                },
                {
                    month: 2,
                    year: 2021
                },
                {
                    month: 3,
                    year: 2021
                },
                {
                    month: 4,
                    year: 2021
                }
            ]),
            /**
             * Manière dont les mois sont écrits.
             * @constant
             * @readonly
             */
            MONTH_NAMES = Object.freeze(["Jan", "Fév", "Mars", "Avr", "Mai", "Juin", "Juil", "Août", "Sept", "Oct", "Nov", "Déc"]);
        
        
        /** 
         * Enum utilisé pour identifier les différents types de graphes.
         * @enum {Symbol}
         * @constant
         * @readonly
         */
        const CHART_TYPE = Object.freeze({
            COLUMN: Symbol("column"),
            PIE: Symbol("pie"),
            LINE: Symbol("line")
        });
        </code></pre>
                    </article>
                </section>




            </div>

            <div id="toolsDoc" style="display: none; margin-left: 300px;">
                <h1 class="page-title">Outils divers</h1>
                <section>
                    <header>
                        <h2>
                        </h2>
                        <ul>
                            <li>Ce fichier contient des fonctions de relativement bas-niveau utiles à multiples reprises.</li>
                            <li>Il s'agit de fonctions d'extraction de données (extraction des données et du nombre de lignes d'un Sheet),
                                de calcul avec la conversion d'un <code><a href="https://developers.google.com/apps-script/reference/charts/chart?hl=en">Chart</a></code> en image
                                et d'interfaçage utilisateur.</li>
                        </ul><br>
                    </header>
                    <article>
                        <div class="container-overview">
                            <dl class="details">


                            </dl>
                        </div>
                        <h3 class="subsection-title">Methods</h3>
                        <div class="section-method">
                            <h4 class="name" id="addHTMLLine"><span class="type-signature"></span>addHTMLLine<span
                                    class="signature">(key, htmlOutput)</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Ajout d'une ligne (dont le contenu est hardcodé et correspond à ajouter une ligne de
                                titre).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line121">line
                                                121</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Clé permettant de retrouver le titre de la ligne à ajouter.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>htmlOutput</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a
                                                        href="https://developers.google.com/apps-script/reference/html/html-output?hl=en">HtmlOutput</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Contenu html à modifier.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="convertChart"><span class="type-signature"></span>convertChart<span
                                    class="signature">(chart, title, htmlOutput, attachments)</span><span
                                    class="type-signature"></span></h4>
                            <div class="description">
                                Conversion d'un graphe de type <a
                                    href="https://developers.google.com/apps-script/reference/charts/chart?hl=en">Chart</a>
                                en une image qui sera ajoutée à un HtmlOutput ainsi qu'à
                                une liste.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line71">line
                                                71</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>chart</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a
                                                        href="https://developers.google.com/apps-script/reference/charts/chart?hl=en">Chart</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Graphe.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>title</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Titre du graphe.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>htmlOutput</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a
                                                        href="https://developers.google.com/apps-script/reference/html/html-output?hl=en">HtmlOutput</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Contenu html qui servira à afficher les graphes à l'écran.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>attachments</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Liste des blobs des images.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="displayLoadingScreen"><span
                                    class="type-signature"></span>displayLoadingScreen<span
                                    class="signature">(msg)</span><span class="type-signature"></span></h4>
                            <div class="description">
                                Affichage d'un écran de chargement.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line87">line
                                                87</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>msg</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Message à afficher en titre.
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                        <div class="section-method">
                            <h4 class="name" id="extractSheetData"><span
                                    class="type-signature"></span>extractSheetData<span
                                    class="signature">(spreadsheetId, sheetName, pos)</span><span
                                    class="type-signature">
                                    &rarr;
                                    {Array}</span></h4>
                            <div class="description">
                                Extrait les données d'un sheet sous forme d'un tableau d'Objects afin d'en faciliter la
                                lecture.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line13">line
                                                13</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>spreadsheetId</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            ID du spreadsheet.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>sheetName</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Nom de l'onglet à extraire.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>pos</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Object contenant deux clés : data et pos pour indiquer la position du header
                                            ainsi
                                            que des données.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Array</code></span>
                                    </dd>
                                    - Array d'Object décrivant l'ensemble des données extraites (1 ligne correspond à
                                    une
                                    ligne du
                                    fichier et les clés sont alors les valeurs du header).
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="manuallyGetRowNumber"><span
                                    class="type-signature"></span>manuallyGetRowNumber<span class="signature">(sheet,
                                    start,
                                    trustColumn)</span><span class="type-signature"> &rarr; {number}</span></h4>
                            <div class="description">
                                Renvoie le nombre de lignes non-vide dans un <a
                                    href="https://developers.google.com/apps-script/reference/spreadsheet/sheet?hl=en">Sheet</a>
                                (pas toujours possible avec <a
                                    href="https://developers.google.com/apps-script/reference/spreadsheet/sheet?hl=en#getLastRow()">getLastRow</a>
                                à
                                cause de la validation des données).
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line27">line
                                                27</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>sheet</code></td>
                                        <td class="type">
                                            <span class="param-type"><code><a
                                                        href="https://developers.google.com/apps-script/reference/spreadsheet/sheet?hl=en">Sheet</a></code></span>
                                        </td>
                                        <td class="description last">
                                            Onglet du sheet à considérer.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>start</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>number</code></span>
                                        </td>
                                        <td class="description last">
                                            Indice de la 1ère ligne contenant des données.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>trustColumn</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>number</code></span>
                                        </td>
                                        <td class="description last">
                                            Indice d'une colonne qui sera vide ssi la ligne est vide.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>number</code></span>
                                    </dd>
                                    - Nombre de lignes de données.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="measureTime"><span class="type-signature"></span>measureTime<span
                                    class="signature">(checkpoint, message)</span><span class="type-signature"> &rarr;
                                    {Date}</span></h4>
                            <div class="description">
                                Log le temps écoulé depuis le checkpoint puis renvoit un nouveau checkpoint.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line131">line
                                                131</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>checkpoint</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Date</code></span>
                                        </td>
                                        <td class="description last">
                                            Date à partir de laquelle le décompte sera fait.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>message</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Message à afficher dans le log (il s'agit seulement de la fin du message, le
                                            début
                                            est hardcodé ici).
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Date</code></span>
                                    </dd>
                                    - Nouveau checkpoint.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="prcnt"><span class="type-signature"></span>prcnt<span
                                    class="signature">(a,
                                    b)</span><span class="type-signature"> &rarr; {number}</span></h4>
                            <div class="description">
                                Renvoie a / b * 100 si b est non nul, 0 sinon.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line54">line
                                                54</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>a</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>number</code></span>
                                        </td>
                                        <td class="description last">
                                            Numérateur.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>b</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>number</code></span>
                                        </td>
                                        <td class="description last">
                                            Dénominateur.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>number</code></span>
                                    </dd> -
                                    a / b * 100.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="sameMonth"><span class="type-signature"></span>sameMonth<span
                                    class="signature">(row, month)</span><span class="type-signature"> &rarr;
                                    {Boolean}</span>
                            </h4>
                            <div class="description">
                                Test vérifiant si une ligne de données correspond à un mois donné.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line62">line
                                                62</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>row</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Ligne de donnée à considérer.
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>month</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Object à deux éléments: month et year.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Boolean</code></span>
                                    </dd>-
                                    true ssi le champ "Premier contact" de la ligne correspond bien au mois spécifié.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="uniqueValues"><span class="type-signature"></span>uniqueValues<span
                                    class="signature">(key, data)</span><span class="type-signature"> &rarr;
                                    {Array}</span>
                            </h4>
                            <div class="description">
                                Renvoie un tableau des valeurs uniques trouvées pour une certaine colonne des données
                                entrées.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line46">line
                                                46</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>key</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>string</code></span>
                                        </td>
                                        <td class="description last">
                                            Clé à considérer (doit être présente dans les éléments de data).
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>data</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Array</code></span>
                                        </td>
                                        <td class="description last">
                                            Données à considérer.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>Array</code></span>
                                    </dd>-
                                    Valeurs uniques se trouvant dans cette colonne.
                                </dl>
                            </div>
                        </div>
                        <div class="section-method">
                            <h4 class="name" id="userQuery"><span class="type-signature"></span>userQuery<span
                                    class="signature">(message, test)</span><span class="type-signature"> &rarr;
                                    {string}</span>
                            </h4>
                            <div class="description">
                                Récupère une entrée de l'utilisateur en ouvrant une fenêtre.
                                Si l'argument message contient une clé 'incorrectInput' l'entrée sera testée et demandée
                                à
                                nouveau jusqu'à ce qu'elle soit validée.
                            </div>
                            <dl class="details">

                                <dt class="tag-source">Source:</dt>
                                <dd class="tag-source">
                                    <ul class="dummy">
                                        <li>
                                            <a class="navtools.js" href="#">tools.js</a>, <a class="navtools.js"
                                                href="#line98">line
                                                98</a>
                                        </li>
                                    </ul>
                                </dd>
                            </dl>
                            <h5>Parameters:</h5>
                            <table class="params">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Type</th>
                                        <th class="last">Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="name"><code>message</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>Object</code></span>
                                        </td>
                                        <td class="description last">
                                            Object décrivant les messages à afficher: titre de la fenêtre, question à
                                            poser
                                            et
                                            message indiquant une entrée non valide (ce dernier est optionnel).
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="name"><code>test</code></td>
                                        <td class="type">
                                            <span class="param-type"><code>function</code></span>
                                        </td>
                                        <td class="description last">
                                            Fonction booléenne permettant de tester l'entrée.
                                        </td>
                                    </tr>
                                </tbody>
                            </table><br/>

                            <div class="section-returns">
                                <h5>Returns:</h5>
                                <dl class="param-type">
                                    <dt>
                                        Type:
                                    </dt>
                                    <dd>
                                        <span class="param-type"><code>string</code></span>
                                    </dd>-
                                    Réponse de l'utilisateur.
                                </dl>
                            </div>
                        </div>
                    </article>
                </section>
            </div>

            <div id="tools.jsDoc" style="display: none; margin-left: 300px;">

                <h1 class="page-title">tools.js</h1>







                <section>
                    <article>
                        <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */
        
        // ----- Data extraction tools -----
        
        // I chose to keep the data as an array of objects (other possibility : object of objects, the keys being the months' names and the values the data in each row)
        /**
         * Extrait les données d'un sheet sous forme d'un tableau d'Objects afin d'en faciliter la lecture.
         * @param {string} spreadsheetId ID du spreadsheet.
         * @param {string} sheetName Nom de l'onglet à extraire.
         * @param {Object} pos Object contenant deux clés : data et pos pour indiquer la position du header ainsi que des données. 
         * @returns {Array} Array d'Object décrivant l'ensemble des données extraites (1 ligne correspond à une ligne du fichier et les clés sont alors les valeurs du header).
         */
        function extractSheetData(spreadsheetId, sheetName, pos) {
            const sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName(sheetName),
                data = sheet.getRange(pos.data.x, pos.data.y, manuallyGetRowNumber(sheet, pos.data.x, pos.trustColumn), (sheet.getLastColumn() - pos.data.y + 1)).getValues(),
                heads = sheet.getRange(pos.header.x, pos.header.y, 1, (sheet.getLastColumn() - pos.header.y + 1)).getValues().shift();
            return data.map(row => heads.reduce((obj, key, idx) => (obj[key] = (row[idx] != "") ? row[idx] : obj[key] || '', obj), {}));
        }
        
        /**
         * Renvoie le nombre de lignes non-vide dans un Sheet (pas toujours possible avec getLastRow à cause de la validation des données).
         * @param {Sheet} sheet Onglet du sheet à considérer.
         * @param {number} start Indice de la 1ère ligne contenant des données.
         * @param {number} trustColumn Indice d'une colonne qui sera vide ssi la ligne est vide.
         * @returns {number} Nombre de lignes de données.
         */
        function manuallyGetRowNumber(sheet, start, trustColumn) {
            // 100 is considered as a higher bound for the number of rows inside of this sheet
            let data = sheet.getRange(start, trustColumn, (100 - start + 1), 1).getValues();
            for (row = 0; row &lt; 100; row++) {
                if ((data[row][0]) == "") {
                    return row;
                }
            }
        }
        
        
        // ----- Computation tools -----
        
        /**
         * Renvoie un tableau des valeurs uniques trouvées pour une certaine colonne des données entrées.
         * @param {string} key Clé à considérer (doit être présente dans les éléments de data).
         * @param {Array} data Données à considérer.
         * @returns {Array} Valeurs uniques se trouvant dans cette colonne.
         */
        const uniqueValues = (key, data) => data.map((row) => row[key]).filter((val, idx, arr) => arr.indexOf(val) == idx);
        
        /**
         * Renvoie a / b * 100 si b est non nul, 0 sinon.
         * @param {number} a Numérateur.
         * @param {number} b Dénominateur.
         * @returns {number} a / b * 100.
         */
        const prcnt = (a, b) => (parseInt(b, 10) == 0) ? 0 : a / b * 100;
        
        /**
         * Test vérifiant si une ligne de données correspond à un mois donné.
         * @param {Object} row Ligne de donnée à considérer.
         * @param {Object} month Object à deux éléments: month et year.
         * @returns {Boolean} true ssi le champ "Premier contact" de la ligne correspond bien au mois spécifié.
         */
        const sameMonth = (row, month) => parseInt(row[HEADS.premierContact].getMonth(), 10) == month.month &amp;&amp; parseInt(row[HEADS.premierContact].getFullYear(), 10) == month.year;
        
        /**
         * Conversion d'un graphe de type Chart en une image qui sera ajoutée à un HtmlOutput ainsi qu'à une liste.
         * @param {Chart} chart Graphe.
         * @param {string} title Titre du graphe.
         * @param {HtmlOutput} htmlOutput Contenu html qui servira à afficher les graphes à l'écran.
         * @param {Array} attachments Liste des blobs des images.
         */
        function convertChart(chart, title, htmlOutput, attachments) {
            // Loading the blob for this chart (this part takes the most time)
            let chartBlob = chart.getAs('image/png');
            // Adding the chart to the HtmlOutput
            htmlOutput.append(`&lt;img border="1" src="data:image/png;base64,${encodeURI(Utilities.base64Encode(chartBlob.getBytes()))}">`);
            // Adding the chart to the attachments
            attachments.push(chartBlob.setName(title));
        }
        
        
        // ----- User's side features -----
        
        /**
         * Affichage d'un écran de chargement.
         * @param {string} msg Message à afficher en titre. 
         */
        function displayLoadingScreen(msg) {
            ui.showModelessDialog(HTML_CONTENT.loadingScreen, msg);
        }
        
        /**
         * Récupère une entrée de l'utilisateur en ouvrant une fenêtre.
         * Si l'argument message contient une clé 'incorrectInput' l'entrée sera testée et demandée à nouveau jusqu'à ce qu'elle soit validée.
         * @param {Object} message Object décrivant les messages à afficher: titre de la fenêtre, question à poser et message indiquant une entrée non valide (ce dernier est optionnel).
         * @param {function} test Fonction booléenne permettant de tester l'entrée.
         * @returns {string} Réponse de l'utilisateur.
         */
        const userQuery = (message, test = (input) => {DriveApp.getFolderById(input);}) => {
            let response = "";
            if (message.incorrectInput != undefined) {
                while (true) {
                    try {
                        response = ui.prompt(message.title, message.query, ui.ButtonSet.OK).getResponseText();
                        // Checking whether the input is valid or not
                        test(response);
                        return response;
                    } catch (e) {
                        ui.alert(message.title, message.incorrectInput, ui.ButtonSet.OK);
                    }
                }
            } else {
                return ui.prompt(message.title, message.query, ui.ButtonSet.OK).getResponseText();
            }
        }
        
        /**
         * Ajout d'une ligne (dont le contenu est hardcodé et correspond à ajouter une ligne de titre).
         * @param {string} key Clé permettant de retrouver le titre de la ligne à ajouter.
         * @param {HtmlOutput} htmlOutput Contenu html à modifier.
         */
        const addHTMLLine = (key, htmlOutput) => {
            htmlOutput.append(`&lt;br/>&lt;br/>&lt;br/>&lt;br/>&lt;span style='font-size: 16pt;'> &lt;span style="font-family: 'roboto', sans-serif;">${TITLES[key]}&lt;br/>&lt;/span> &lt;/span> &lt;br/>`)
        };
        
        /**
         * Log le temps écoulé depuis le checkpoint puis renvoit un nouveau checkpoint.
         * @param {Date} checkpoint Date à partir de laquelle le décompte sera fait.
         * @param {string} message Message à afficher dans le log (il s'agit seulement de la fin du message, le début est hardcodé ici).
         * @returns {Date} Nouveau checkpoint.
         */
        const measureTime = (checkpoint, message) => {
            let newCheckpoint = new Date();
            Logger.log(`It took ${(newCheckpoint.getTime() - checkpoint.getTime()) / 1000} s to ${message}.`);
            return newCheckpoint;
        };
        
        // There will be a time when this decorator will be put to a good use
        const logTime = (message) => ((target, name, descriptor) => {
            let initialTime = new Date();
            descriptor.value();
            measureTime(initialTime, message);
        });
        </code></pre>
                    </article>
                </section>




            </div>
        </div>

        <div id="stopLine" class="b-example-divider"></div>

        <footer id="footer" class="bd-footer p-3 p-md-5 mt-5 bg-light text-center text-sm-start">
            <div class="container">
                <p class="float-end"><a href="#">Retour en haut</a></p>
                <ul class="bd-footer-links ps-0 mb-3">
                    <li class="d-inline-block"><a href="https://github.com/aubin-tchoi/Polkali" target="_blank">GitHub du Pôle
                            Qualité</a></li> &nbsp; &nbsp;
                    <li class="d-inline-block"><a
                            href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app" target="_blank">Documentation
                            Google</a></li> &nbsp; &nbsp;
                    <li class="d-inline-block"><a href="https://junior-pep.fr/" target="_blank">Site de PEP</a></li> &nbsp; &nbsp;
                    <li class="d-inline-block"><a
                            href="https://drive.google.com/drive/u/0/folders/0ABSba9Eyz2sgUk9PVA" target="_blank">Drive du Pôle
                            Qualité</a></li>
                </ul>
                <p class="mb-0">Ponts Études Projets &middot; Pôle Qualité &middot; mandat 022</a></p>
            </div>
        </footer>
    </main>

    <script>
        const buttons = ["charts", "dataTables", "features", "Main", "parameters", "tools"];

        /** Home button */
        document.getElementById("HomeButton").addEventListener("click", showHome);
        // document.getElementById("navHome").addEventListener("click", showHome);

        /** Adding onClick events to some buttons (on the front page and inside of the navbar) */
        buttons.forEach(button => {
            /** Buttons leading to a certain file */
            document.getElementById(button).addEventListener("click", showFile(button));
            /** Buttons leading to file of code */
            document.getElementById(`${button}.js`).addEventListener("click", showFile(`${button}.js`));
            /** Buttons leading to each file inside of the navbar */
            Array.prototype.forEach.call(document.getElementsByClassName(`nav${button}`), el => {
                el.addEventListener("click", showFile(button));
            });
            /** Buttons leading from a file to its code */
            Array.prototype.forEach.call(document.getElementsByClassName(`nav${button}.js`), el => {
                el.addEventListener("click", showFile(`${button}.js`));
            });
        });

        /** Hiding all files */
        function hideFiles() {
            buttons.forEach(f => {
                document.getElementById(`${f}Doc`).style.display = "None";
                document.getElementById(`${f}.jsDoc`).style.display = "None";
            });
        }

        /** Hiding the home page */
        function hideHome() {
            document.getElementById("Home").style.display = "None";
        }

        /** Showing a specific file */
        function showFile(file) {
            return () => {
                // Hiding the home page + all the files
                hideHome();
                hideFiles();
                // Showing the navbar + 1 specific file
                document.getElementById("navFiles").style.display = "";
                document.getElementById(`${file}Doc`).style.display = "";
            }
        }

        /** Showing the home page */
        function showHome() {
            // Hiding files + navbar
            hideFiles();
            document.getElementById("navFiles").style.display = "None";
            // Displaying the home page
            document.getElementById("Home").style.display = "";
        }
    </script>
    
    <script>
        /** Making sure that the navbar will stop at the footer */
        /*
        let socialFloat = document.querySelector('#navFiles'),
            footer = document.querySelector('#stopLine');

        function checkOffset() {
            function getRectTop(el) {
                return el.getBoundingClientRect().top;
            }

            // Scrolling down until the navbar reaches the footer
            if ((getRectTop(socialFloat) + document.body.scrollTop) + socialFloat.offsetHeight >= (getRectTop(footer) +
                    document.body.scrollTop)) {
                //socialFloat.style.top = `${document.getElementById("Doc").clientHeight - window.screen.height}px`;
                socialFloat.scrollTop = window.screen.height - getRectTop(footer);
                socialFloat.style.position = 'relative';
                console.log(`Window innerHeight : ${document.getElementById("Doc").clientHeight}`);
                console.log(`Footer : ${getRectTop(footer)}`);
            }
            // Scrolling up to make the navbar stick again
            if (document.body.scrollTop + window.innerHeight < (getRectTop(footer) + document.body.scrollTop)) {
                socialFloat.style.position = 'relative';
                socialFloat.style.top = "0px";
            }
        }

        document.addEventListener("scroll", function () {
            checkOffset();
        }); */
    </script>

    <script>
        /*global document */
        (function() {
            var source = document.getElementsByClassName('prettyprint source linenums');
            var i = 0;
            var lineNumber = 0;
            var lineId;
            var lines;
            var totalLines;
            var anchorHash;

            if (source && source[0]) {
                anchorHash = document.location.hash.substring(1);
                lines = source[0].getElementsByTagName('li');
                totalLines = lines.length;

                for (; i < totalLines; i++) {
                    lineNumber++;
                    lineId = 'line' + lineNumber;
                    lines[i].id = lineId;
                    if (lineId === anchorHash) {
                        lines[i].className += ' selected';
                    }
                }
            }
        })();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
    </script>

    <script>
        // Slides generation
        function loadSlides(callback) {
            return new Promise(function(resolve, reject) {
                setTimeout(function() {
                    let element = document.getElementById("genSlides");
                element.className = "";
                element.innerHTML = `<svg width="160" height="47" fill="currentColor" viewBox="0 0 16 16">
                                    <image width=100% height=100% href="https://kodular-community.s3.dualstack.eu-west-1.amazonaws.com/original/2X/c/c09b32fba2ce347fd7bc63c4fba681bac039e7ca.gif">
                                    </image></svg>`;
                google.script.run.generateSlides();
                callback();
                resolve();
                }, 3000);
            })
        }

        function restore() {
            let element = document.getElementById("genSlides");
            element.className = "btn btn-lg btn-primary";
            element.innerHTML = "Créer les slides";
        }

        document.getElementById("genSlides").addEventListener("click", loadSlides().then(restore));
    </script>

</body>

</html>
