<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>charts.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="../accueil.html"> Accueil</a></li>
    <li class="nav-heading"><a href="main.html">main.js</a></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#autoSaveKPI">autoSaveKPI</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#displayKPI">displayKPI</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#generateKPI">generateKPI</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#installTrigger">installTrigger</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#prepCA">prepCA</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="main.html#saveKPI">saveKPI</a></span></li>

    <li class="nav-heading"><a href="dataTables.html">dataTables</a></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#conversionRate">conversionRate</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#numberOfMissions">numberOfMissions</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#performance">performance</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#totalDistribution">totalDistribution</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#turnoverDistribution">turnoverDistribution</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="dataTables.html#turnoverDistributionBinary">turnoverDistributionBinary</a></span></li>

    <li class="nav-heading"><a href="charts.html">charts</a></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="charts.html#addOptions">addOptions</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="charts.html#createChart">createChart</a></span></li>

    <li class="nav-heading"><a href="features.html">features</a></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="features.html#generateSlides">generateSlides</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="features.html#saveOnDrive">saveOnDrive</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="features.html#sendMail">sendMail</a></span></li>

    <li class="nav-heading"><a href="tools.html">tools</a></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#addHTMLLine">addHTMLLine</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#convertChart">convertChart</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#displayLoadingScreen">displayLoadingScreen</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#extractSheetData">extractSheetData</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#manuallyGetRowNumber">manuallyGetRowNumber</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#measureTime">measureTime</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#prcnt">prcnt</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#sameMonth">sameMonth</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#uniqueValues">uniqueValues</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a
                href="tools.html#userQuery">userQuery</a></span></li>

    <li class="nav-heading"><a href="parameters.html">parameters</a></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#ADDRESSES">ADDRESSES</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#CHART_TYPE">CHART_TYPE</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#COLORS">COLORS</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#CONTACT_TYPE">CONTACT_TYPE</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#DIMS">DIMS</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#ETAT_ETUDE">ETAT_ETUDE</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#ETAT_PROSP">ETAT_PROSP</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#ETAT_PROSP_BIS">ETAT_PROSP_BIS</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#HEADS">HEADS</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#HTML_CONTENT">HTML_CONTENT</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#IMGS">IMGS</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#MONTH_LIST">MONTH_LIST</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#MONTH_NAMES">MONTH_NAMES</a></span></li>
    <li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a
                href="parameters.html#TITLES">TITLES</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">charts.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* Si vous avez des questions à propos de ce script contactez Aubin Tchoï (Directeur Qualité 022) */

// Creating charts using a data table as input

// Creating a chart using one of the different builders among PieChart, ColumnChart and LineChart
/**
 * Creation d'un graphe au type Chart.
 * @param {Enum} chartType - Type du graphe (Pie, Line, Column).
 * @param {DataTable} dataTable - Table de données à utiliser.
 * @param {string} title - Titre du graphe.
 * @param {Object} options - Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
 * @returns {Chart} - Graphe complet.
 */
function createChart(chartType, dataTable, title, options = {}) {
    Logger.log(`Creating chart ${title} of type ${Object.keys(CHART_TYPE)[Object.values(CHART_TYPE).indexOf(chartType)]} with ${!options ? "no option" : `options : ${Object.entries(options)}`}.`);
    try {
        if (chartType === CHART_TYPE.COLUMN) {
            return addOptions(Charts.newColumnChart().setDataTable(dataTable), title, options);
        } else if (chartType === CHART_TYPE.PIE) {
            return addOptions(Charts.newPieChart().setDataTable(dataTable), title, options);
        } else if (chartType === CHART_TYPE.LINE) {
            return addOptions(Charts.newLineChart().setDataTable(dataTable).setOption('curveType', 'function').setOption('pointSize', 10).setOption('pointShape', 'diamond'), title, options);
        }
    } catch (e) {
        Logger.log(`Could not create graph for info : ${title}, error : ${e}`);
    }
}

// Add options to a chartBuilder
/** 
 * Ajouter des options à un chartBuilder (appelée par createChart).
 * @param {ChartBuilder} chartBuilder - ChartBuilder utilisé.
 * @param {string} title - Titre du graphe.
 * @param {Object} options - Options modifiant les propriétés du graphe (dimensions, couleurs, ...).
 */
function addOptions(chartBuilder, title, options) {
    return chartBuilder
        .setOption('legend', {
            textStyle: {
                font: 'roboto',
                fontSize: 11
            }
        })
        .setOption('colors', options.colors || Object.values(COLORS))
        .setOption('vAxis.minValue', (options.percent || false) ? 0 : 'automatic')
        .setOption('vAxis.maxValue', (options.percent || false) ? 100 : 'automatic')
        .setOption('hAxis.ticks', options.hticks || 'auto')
        .setOption('vAxis.ticks', options.vticks || 'auto')
        .setTitle(title)
        .setDimensions(options.width || DIMS.width, options.height || DIMS.height)
        .build();
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer class="bd-footer p-3 p-md-5 mt-5 bg-light text-center text-sm-start">
    <div class="container">
        <p class="float-end"><a href="#">Retour en haut</a></p>
        <ul class="bd-footer-links ps-0 mb-3">
            <li class="d-inline-block"><a
                    href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app">Documentation
                    Google</a></li>
        </ul>
        <p class="mb-0">Ponts Études Projets &middot; Pôle Qualité &middot; mandat 022</a></p>
    </div>
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
