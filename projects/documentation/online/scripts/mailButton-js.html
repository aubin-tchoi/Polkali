<script>
    /** Sending KPI in a mail */
    document.getElementById("mailButton").addEventListener("click", sendKPIByMail);

    function sendKPIByMail() {
        let mailAddress = document.getElementById("floatingInput").value;
        google.script.run.withSuccessHandler(restoreSecondSlide).sendMail(mailAddress);
        let element = document.getElementById("mailButton");
        element.className = "";
        element.innerHTML = `<svg width="160" height="47" fill="currentColor" viewBox="0 0 16 16">
                        <image width=100% height=100% href="https://kodular-community.s3.dualstack.eu-west-1.amazonaws.com/original/2X/c/c09b32fba2ce347fd7bc63c4fba681bac039e7ca.gif">
                        </image></svg>`;
        console.log("Sending mail");
    }

    function restoreSecondSlide() {
        console.log("Mail sent");
        let element = document.getElementById("mailButton");
        element.className = "btn btn-lg btn-primary";
        element.innerHTML = `Mail envoyé avec succès`;
    }
</script>
